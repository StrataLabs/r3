var CLICKDESK_Live_Chat;var JSON=JSON||{};JSON.stringify=JSON.stringify||function(e){var d=typeof(e);if(d!="object"||e===null){if(d=="string"){e='"'+e+'"'}return String(e)}else{var f,b,c=[],a=(e&&e.constructor==Array);for(f in e){b=e[f];d=typeof(b);if(d=="string"){b='"'+b+'"'}else{if(d=="object"&&b!==null){b=JSON.stringify(b)}}c.push((a?"":'"'+f+'":')+String(b))}return(a?"[":"{")+String(c)+(a?"]":"}")}};JSON.parse=JSON.parse||function(str){if(str===""){str='""'}eval("var p="+str+";");return p};function addlivilyEvent(e,b,d){try{var a=document.getElementById(e);if(a.addEventListener){a.addEventListener(b,function(f){if(d!==undefined&&d!=null){d(f)}},true)}else{a.attachEvent("on"+b,function(f){if(d!==undefined&&d!=null){d(f)}},true)}}catch(c){clickdeskLog("addEvent ="+c)}}function clickdeskAttachEvent(b,a,d){try{if(IS_MOOTOOLS_PRESENT){$$(b).addEvent(a,function(f){if(d!==undefined&&d!=null){d(f)}})}else{snack.wrap(b).attach(a,function(f){if(d!==undefined&&d!=null){d(f)}})}}catch(c){clickdeskLog("addEvent ="+c)}}function constructSnackRequest(b,a){var c={url:a,method:"post",key:"callback",data:b};return c}function createDOMElement(a,d,c){var b;if(a!==undefined&&a!=null){b=document.createElement(a)}if(d!==undefined&&d!=null){b.setAttribute("id",d)}if(c!==undefined&&c!=null){b.className=c}return b}function removeElement(e,d){try{var b=document.getElementById(e);if(b!=null&&b!==undefined){for(var a=0;a<b.childNodes.length;a++){if(b.childNodes[a].className==d){b.childNodes[a].parentNode.removeChild(b.childNodes[a])}}}}catch(c){clickdeskLog("removeElement = "+c)}}function hasClass(b,a){var c;if(b.charAt("0")=="#"){c=clickdeskElementWrap(b)}else{c=clickdeskElementWrap("."+b)}var d=false;snack.each(c,function(f){var e=new RegExp("(^| )"+a+"( |$)");if(e.test(f.className)){d=true}});return d}function clickdeskElementWrap(a){try{if(IS_MOOTOOLS_PRESENT){return $$(a)}else{return snack.wrap(a)}}catch(b){clickdeskLog("clickdeskWrap = "+b)}}function nodeValid(b){var a=document.getElementById(b);if(a!=undefined){return true}else{return false}}function setElementStyleByID(b,a){try{var d=document.getElementById(b);setElementStyleByObject(d,a)}catch(c){clickdeskLog("setStyle = "+c)}}function setElementStyleByObject(d,a){try{var e=d;if(e!==undefined&&e!=null){for(var c in a){e.style[c]=a[c]}}}catch(b){clickdeskLog("setStyle = "+b)}}if(cd_ie_browser_version>5){document.onfocusin=CLICKDESK_onFocus}else{window.onfocus=CLICKDESK_onFocus}var blinkTimer;var originalTitle=document.title;function CLICKDESK_onFocus(){if(blinkTimer!==undefined){clearTimeout(blinkTimer)}document.title=originalTitle}function blinkTitle(b,a){blinkingTitle(a,b,true)}function blinkingTitle(c,b,a){if(a){document.title=b}else{document.title=originalTitle;c--;clearTimeout(blinkTimer)}if(c>0){blinkTimer=setTimeout("blinkingTitle("+c+", '"+b+"', "+!a+")",800)}}function removeDomByClassName(c){var b=clickdeskElementWrap("."+c);for(var a=0;a<b.length;a++){document.body.removeChild(b[a])}}function cdCheckDoctypeInIE(){if(cd_ie_browser_version>5){if(cd_ie_browser_version==6||!CDSupportsFixed()){var b=widgetPrefsJSON.bubble.alignment;if(b!==undefined&&b!=null){if(b=="bottom_right"){clickdeskElementWrap("#livilyChatButton").addClass("clickdesk-fixed-bottom");clickdeskElementWrap("#livilyChatButton").addClass("clickdesk-fixed-right");clickdeskElementWrap("#livechat_container").addClass("clickdesk-fixed-bottom");clickdeskElementWrap("#livechat_container").addClass("clickdesk-fixed-right")}else{if(b=="bottom_left"){clickdeskElementWrap("#livilyChatButton").addClass("clickdesk-fixed-bottom");clickdeskElementWrap("#livilyChatButton").addClass("clickdesk-fixed-left");clickdeskElementWrap("#livechat_container").addClass("clickdesk-fixed-bottom");clickdeskElementWrap("#livechat_container").addClass("clickdesk-fixed-left")}else{if(b=="top_right"){clickdeskElementWrap("#livilyChatButton").addClass("clickdesk-fixed-top");clickdeskElementWrap("#livilyChatButton").addClass("clickdesk-fixed-right");clickdeskElementWrap("#clickdesk_container").addClass("clickdesk-fixed-bottom");clickdeskElementWrap("#clickdesk_container").addClass("clickdesk-fixed-right")}else{if(b=="top_left"){clickdeskElementWrap("#livilyChatButton").addClass("clickdesk-fixed-top");clickdeskElementWrap("#livilyChatButton").addClass("clickdesk-fixed-left");clickdeskElementWrap("#livechat_container").addClass("clickdesk-fixed-bottom");clickdeskElementWrap("#livechat_container").addClass("clickdesk-fixed-left")}}}}setElementStyleByID("livilyChatButton",{width:"260px",maxWidth:"280px"});var a=widgetPrefsJSON.button.alignment;clickdeskElementWrap("#livilytoolbarbutton").addClass("clickdesk-fixed-"+a)}setElementStyleByID("livechat_controls",{marginRight:"10px"});setElementStyleByID("livilyfooter_tools",{top:"0px",position:"relative"});setElementStyleByID("livilyfooter_social",{"float":"none",position:"relative",height:"20px"});clickdeskElementWrap("#livily_offline_button").addClass("clickdesk-fixed-button");clickdeskElementWrap("#livily_prechat_button").addClass("clickdesk-fixed-button");setElementStyleByID("livily_etv_submit",{width:"90px",overflow:"hidden"});setElementStyleByID("livily_etv_cancel",{width:"90px",overflow:"hidden"})}}}function CDSupportsFixed(){var a=document.createElement("div");a.id="testingPositionFixed";a.style.position="fixed";a.style.top="0px";a.style.right="0px";document.body.appendChild(a);var c=1;try{if(typeof a.offsetTop=="number"&&a.offsetTop!=null&&a.offsetTop!="undefined"){c=parseInt(a.offsetTop)}if(c==0){return true}return false}catch(b){return false}}function CLICKDESK_createCookie(c,d,e){c=CLICKDESK_WIDGET_ID+"-"+c;if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/"}function checkChatActiveTab(){clickdeskLog("checkChatActiveTab");if(typeof(localStorage)=="undefined"){try{if(CLICKDESK_RANDOM_NUMBER==readSessionCookie("tabSelect")){var a=setTimeout("checkChatActiveTab()",4000)}else{removeDomByClassName("livilyChatButton");document.body.removeChild(document.getElementById("livechat_container"))}}catch(b){clickdeskLog("checkChatActiveTab "+b)}}else{try{if(CLICKDESK_RANDOM_NUMBER==localStorage.getItem("tabSelect")){var a=setTimeout("checkChatActiveTab()",4000)}else{removeDomByClassName("livilyChatButton");document.body.removeChild(document.getElementById("livechat_container"))}}catch(b){if(b===QUOTA_EXCEEDED_ERR){clickdeskLog("Quota exceeded!")}}}}function cdloadCSS(b){var a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",b);if(typeof a!="undefined"){document.getElementsByTagName("head")[0].appendChild(a)}}CLICKDESK_RANDOM_NUMBER=Math.floor(Math.random()*100);if(typeof(localStorage)==="undefined"){CLICKDESK_createCookie("tabSelect",CLICKDESK_RANDOM_NUMBER)}else{try{localStorage.setItem("tabSelect",CLICKDESK_RANDOM_NUMBER)}catch(error){try{if(error==QUOTA_EXCEEDED_ERR){clickdeskLog("Quota exceeded!")}}catch(e1){clickdeskLog("e1 ="+e1)}}}checkChatActiveTab();CLICKDESK_Live_Chat={setName:function(a){CLICKDESK_attempt(function(){return CLICKDESK_setName(a)})},setEmail:function(a){CLICKDESK_attempt(function(){return CLICKDESK_setEmail(a)})},setMessage:function(a){CLICKDESK_attempt(function(){return CLICKDESK_setMessage(a)})},setPrefs:function(a){CLICKDESK_attempt(function(){return CLICKDESK_setPrefs(a)})},onStatus:function(a){CLICKDESK_attempt(function(){return CLICKDESK_onStatus(a)})},setBubbleText:function(a){CLICKDESK_attempt(function(){return CLICKDESK_setBubbleText(a)})}};function CLICKDESK_onStatus(c){var a={};a.widget_id="ag9jb250YWN0dXN3aWRnZXRyDQsSB3dpZGdldHMYdAw";a.command="online_status";var b=constructSnackRequest(a,"http://localhost:8888/visitor");snack.JSONP(b,function(d){clickdeskLog(d);var e="";if(d.status=="success"){e=d.response.status}else{e=d.errormssg}if(c!==undefined){c(e)}})}function CLICKDESK_setBubbleText(a){try{clickdeskElementWrap("#clickdesk_notification_text")[0].innerHTML=a;return false}catch(b){console.log("err in API = "+b)}}function CLICKDESK_setName(a){try{if(OFFLINE_FIRSTFIELDEMAILVSTEXT=="text"){document.getElementById("offline_name").value=a}if(OFFLINE_SECONDFIELDEMAILVSTEXT=="text"){document.getElementById("offline_email").value=a}if(PRECHAT_FIRSTFIELDEMAILVSTEXT=="text"){document.getElementById("prechat_name").value=a}if(PRECHAT_SECONDFIELDEMAILVSTEXT=="text"){document.getElementById("prechat_email").value=a}CLICKDESK_createCookie("visitor_name",a);return CLICKDESK_cancelEvent(a)}catch(b){clickdeskLog("err in API = "+b)}}function CLICKDESK_setEmail(a){try{if(OFFLINE_FIRSTFIELDEMAILVSTEXT=="email"){document.getElementById("offline_name").value=a}if(OFFLINE_SECONDFIELDEMAILVSTEXT=="email"){document.getElementById("offline_email").value=a}if(PRECHAT_FIRSTFIELDEMAILVSTEXT=="email"){document.getElementById("prechat_name").value=a}if(PRECHAT_SECONDFIELDEMAILVSTEXT=="email"){document.getElementById("prechat_email").value=a}CLICKDESK_createCookie("visitor_email",a);return CLICKDESK_cancelEvent(a)}catch(b){clickdeskLog("err in API = "+b)}}function CLICKDESK_setMessage(a){try{document.getElementById("prechat_msg").value=a;document.getElementById("offline_msg").value=a;return CLICKDESK_cancelEvent(a)}catch(b){clickdeskLog("err in API = "+b)}}function CLICKDESK_setPrefs(a){try{if(typeof(a)=="object"){for(key in a){if(key=="name"){CLICKDESK_Live_Chat.setName(a[key])}if(key=="email"){CLICKDESK_Live_Chat.setEmail(a[key])}if(key=="message"){CLICKDESK_Live_Chat.setMessage(a[key])}if(key=="onStatus"){CLICKDESK_Live_Chat.onStatus(a[key])}if(key=="bubbleText"){CLICKDESK_Live_Chat.setBubbleText(a[key])}}}return CLICKDESK_cancelEvent(a)}catch(b){console.log("err in API = "+b)}}typeof Object.create!="function"&&(Object.create=function(d){function c(){}c.prototype=d;return new c}),!function(g){var f=g.snack={},k=0,j=Object.prototype.toString,h=Array.prototype.indexOf;f.extend=function(){if(arguments.length==1){return f.extend(f,arguments[0])}var b=arguments[0];for(var n,m=1,l=arguments.length;m<l;m++){for(n in arguments[m]){b[n]=arguments[m][n]}}return b},f.extend({v:"1.2.1",bind:function(e,d,l){return function(){return e.apply(d,l||arguments)}},punch:function(b,o,n,m){var l=b[o];b[o]=m?function(){l.apply(b,arguments);return n.apply(b,arguments)}:function(){var a=[].slice.call(arguments,0);a.unshift(f.bind(l,b));return n.apply(b,a)}},create:function(b,l){var e=Object.create(b);if(!l){return e}for(i in l){if(!l.hasOwnProperty(i)){continue}if(!b[i]||typeof l[i]!="function"){e[i]=l[i];continue}f.punch(e,i,l[i])}return e},id:function(){return ++k},each:function(m,l,r){if(m.length===void 0){for(var q in m){m.hasOwnProperty(q)&&l.call(r,m[q],q,m)}return m}for(var o=0,n=m.length;o<n;o++){l.call(r,m[o],o,m)}return m},parseJSON:function(a){if(typeof a=="string"){a=a.replace(/^\s+|\s+$/g,"");var l=/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""));if(!l){throw"Invalid JSON"}var e=g.JSON;return e&&e.parse?e.parse(a):(new Function("return "+a))()}},isArray:function(b){return b instanceof Array||j.call(b)=="[object Array]"},indexOf:h?function(d,c){return h.call(c,d)}:function(l,e){for(var n=0,m=e.length;n<m;n++){if(e[n]===l){return n}}return -1}})}(window),!function(f,e){var h={},g;f.wrap=function(a,k){typeof a=="string"&&(a=g(a,k)),a.length||(a=[a]);var j=Object.create(h),d=0,c=a.length;for(;d<c;d++){j[d]=a[d]}j.length=c,j.id=f.id();return j},f.extend(f.wrap,{define:function(a,c){if(typeof a!="string"){for(i in a){f.wrap.define(i,a[i])}}else{h[a]=c}},defineEngine:function(b){g=b}}),f.wrap.defineEngine(function(b,d){typeof d=="string"&&(d=e.querySelector(d));return(d||e).querySelectorAll(b)})}(snack,document),!function(A,z,y){function o(){try{s.doScroll("left")}catch(b){setTimeout(o,50);return}q("poll")}function q(a){if(a.type!="readystatechange"||y.readyState=="complete"){(a.type=="load"?z:y)[w](v+a.type,q,!1),!u&&(u=!0)&&A.each(r,function(b){b.apply(y)})}}var x=y.addEventListener?"addEventListener":"attachEvent",w=y.addEventListener?"removeEventListener":"detachEvent",v=y.addEventListener?"":"on",u=!1,t=!0,s=y.documentElement,r=[];A.extend({stopPropagation:function(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0},preventDefault:function(b){b.preventDefault?b.preventDefault():b.returnValue=!1}}),A.listener=function(a,d){a.delegate&&(a.capture=!0,_handler=d,d=function(h){var g=h.target||h.srcElement,b=typeof a.delegate=="string"?A.wrap(a.delegate,a.node):a.delegate(a.node);while(g&&A.indexOf(g,b)==-1){g=g.parentNode}g&&g!==this&&g!==y&&_handler.call(g,h,g)}),a.context&&(d=A.bind(d,a.context));var c={attach:function(){a.node[x](v+a.event,d,a.capture)},detach:function(){a.node[w](v+a.event,d,a.capture)},fire:function(){d.apply(a.node,arguments)}};c.attach();return c},A.ready=function(b){u?b.apply(y):r.push(b)};if(y.createEventObject&&s.doScroll){try{t=!z.frameElement}catch(n){}t&&o()}y[x](v+"DOMContentLoaded",q,!1),y[x](v+"readystatechange",q,!1),z[x](v+"load",q,!1)}(snack,window,document),!function(b){b.publisher=function(a){var d={};a=a||{},b.extend(a,{subscribe:function(c,l,k){var j={fn:l,ctxt:k||{}};d[c]||(d[c]=[]);var h={attach:function(){d[c].push(j)},detach:function(){d[c].splice(b.indexOf(l,d[c]),1)}};h.attach();return h},publish:function(c,e){if(!d[c]){return !1}b.each(d[c],function(f){f.fn.apply(f.ctxt,e||[])});return d[c].length}});return a},b.publisher(b)}(snack),!function(g,f,k){function h(){}g.JSONP=function(a,o){var n="jsonp"+g.id(),m=k.createElement("script"),l=!1;g.JSONP[n]=function(d){l=!1,delete g.JSONP[n],o(d)},typeof a.data=="object"&&(a.data=g.toQueryString(a.data));var c={send:function(){l=!0,m.src=a.url+"?"+a.key+"=snack.JSONP."+n+"&"+a.data,k.getElementsByTagName("head")[0].appendChild(m)},cancel:function(){l&&m.parentNode&&m.parentNode.removeChild(m),l=!1,g.JSONP[n]=function(){delete g.JSONP[n]}}};a.now!==!1&&c.send();return c},g.toQueryString=function(a,l){var e=[];g.each(a,function(c,n){l&&(n=l+"["+n+"]");var m;switch(g.isArray(c)){case"object":m=g.toQueryString(c,n);break;case"array":var d={};g.each(c,function(q,o){d[o]=q}),m=g.toQueryString(d,n);break;default:m=n+"="+encodeURIComponent(c)}c!==null&&e.push(m)});return e.join("&")};var j=function(){var l=function(){return new XMLHttpRequest},e=function(){return new ActiveXObject("MSXML2.XMLHTTP")},n=function(){return new ActiveXObject("Microsoft.XMLHTTP")};try{l();return l}catch(m){try{e();return e}catch(m){n();return n}}}();g.request=function(a,l){if(!(this instanceof g.request)){return new g.request(a,l)}var d=this;d.options=g.extend({},d.options,a),d.callback=l,d.xhr=new j,d.headers=d.options.headers,d.options.now!==!1&&d.send()},g.request.prototype={options:{exception:h,url:"",data:"",method:"get",now:!0,headers:{"X-Requested-With":"XMLHttpRequest",Accept:"text/javascript, text/html, application/xml, text/xml, */*"},async:!0,emulation:!0,urlEncoded:!0,encoding:"utf-8"},onStateChange:function(){var l=this,e=l.xhr;if(e.readyState==4&&!!l.running){l.running=!1,l.status=0;try{var o=e.status;l.status=o==1223?204:o}catch(n){}e.onreadystatechange=h;var m=l.status>=200&&l.status<300?[!1,l.xhr.responseText||"",l.xhr.responseXML]:[l.status];l.callback.apply(l,m)}},setHeader:function(d,c){this.headers[d]=c;return this},getHeader:function(d){try{return this.xhr.getResponseHeader(d)}catch(c){return null}},send:function(){var v=this,u=v.options;if(v.running){return v}v.running=!0;var t=u.data||"",s=String(u.url),r=u.method.toLowerCase();typeof t!="string"&&(t=g.toQueryString(t));if(u.emulation&&g.indexOf(r,["get","post"])<0){var q="_method="+r;t=t?q+"&"+t:q,r="post"}if(u.urlEncoded&&g.indexOf(r,["post","put"])>-1){var o=u.encoding?"; charset="+u.encoding:"";v.headers["Content-type"]="application/x-www-form-urlencoded"+o}s||(s=k.location.pathname);var n=s.lastIndexOf("/");n>-1&&(n=s.indexOf("#"))>-1&&(s=s.substr(0,n)),t&&r=="get"&&(s+=(s.indexOf("?")>-1?"&":"?")+t,t=null);var c=v.xhr;c.open(r.toUpperCase(),s,open.async,u.user,u.password),u.user&&"withCredentials" in c&&(c.withCredentials=!0),c.onreadystatechange=g.bind(v.onStateChange,v);for(i in v.headers){try{c.setRequestHeader(i,v.headers[i])}catch(a){u.exception.apply(v,[i,v.headers[i]])}}c.send(t),u.async||v.onStateChange();return v},cancel:function(){var d=this;if(!d.running){return d}d.running=!1;var c=d.xhr;c.abort(),c.onreadystatechange=h,d.xhr=new j;return d}}}(snack,window,document),!function(f,e){function g(a,m,l,k){var j=a.data(l);j&&f.each(j,function(b){b[m].apply(a,k)});return a}function h(b){return b.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"")}f.wrap.define({data:function(){var b={};return function(a,k){var j=b[this.id];j||(j=b[this.id]={});if(k===void 1){return j[a]}return j[a]=k}}(),each:function(a,d){return f.each(this,a,d)},addClass:function(b){return this.each(function(a){h(a.className).indexOf(b)>-1||(a.className=h(a.className+" "+b))})},removeClass:function(b){return this.each(function(a){a.className=a.className.replace(new RegExp("(^|\\s)"+b+"(?:\\s|$)"),"$1")})},attach:function(a,m,l){var k=a.split("."),j=[];k[1]&&(j=this.data(k[1])||[]),this.each(function(c){var d={node:c,event:k[0]};l&&(d.delegate=l),j.push(f.listener(d,m))}),k[1]&&this.data(k[1],j);return this},detach:function(b){g(this,"detach",b,null,!0),this.data(b,null);return this},fire:function(d,c){return g(this,"fire",d,c)},delegate:function(j,d,k){return this.attach(j,k,d)}})}(snack,document),!function(aY,aX){function ab(f){var e=[],h,g;label:for(h=0;h<f.length;h++){for(g=0;g<e.length;g++){if(e[g]==f[h]){continue label}}e[e.length]=f[h]}return e}function ac(b,f){var e=typeof f=="string"?ac(f)[0]:f||aX;if(!e||!b){return[]}if(aR=ae(b,f,ac)){return aR}if(aX.getElementsByClassName&&(aR=b.match(aA))){return ar(e.getElementsByClassName(aR[1]))}return ar(e.querySelectorAll(b))}function ad(b){return b===window||b&&b.nodeType&&b.nodeType.toString().match(/[19]/)}function ae(b,h,g){var f=typeof h=="string"?g(h)[0]:h||aX;if(ad(b)){return !h||ad(f)&&af(b,f)?[b]:[]}if(b&&typeof b=="object"&&isFinite(b.length)){return ar(b)}if(aR=b.match(aB)){return(aM=aX.getElementById(aR[1]))?[aM]:[]}if(aR=b.match(az)){return ar(f.getElementsByTagName(aR[1]))}return !1}function ag(f){var e=[],m=[],l,k,j=am.g(f)||am.s(f,f.split(aw));j=j.slice(0);if(!j.length){return e}e=aj(j);if(!j.length){return e}for(aU=0,k=e.length,aT=0;aU<k;aU++){aL=e[aU],aP=aL;for(l=j.length;l--;){az:while(aP!==ax&&(aP=aP.parentNode)){if(aJ=ak.apply(aP,al(j[l]))){break az}}}aJ&&(m[aT++]=aL)}return m}function ah(e,d,f){switch(e){case"=":return d==f;case"^=":return d.match(an.g("^="+f)||an.s("^="+f,new RegExp("^"+ai(f))));case"$=":return d.match(an.g("$="+f)||an.s("$="+f,new RegExp(ai(f)+"$")));case"*=":return d.match(an.g(f)||an.s(f,new RegExp(ai(f))));case"~=":return d.match(an.g("~="+f)||an.s("~="+f,new RegExp("(?:^|\\s+)"+ai(f)+"(?:\\s+|$)")));case"|=":return d.match(an.g("|="+f)||an.s("|="+f,new RegExp("^"+ai(f)+"(-|$)")))}return !1}function ai(b){return ao.g(b)||ao.s(b,b.replace(/([.*+?\^=!:${}()|\[\]\/\\])/g,"\\$1"))}function aj(s){var r=[],q=s.pop(),o=al(q),n=o[1]||"*",m,l,h,b=s.length&&(aR=s[0].match(aB))?aX.getElementById(aR[1]):aX;if(!b){return r}h=b.getElementsByTagName(n);for(m=0,l=h.length;m<l;m++){aM=h[m],(aH=ak.apply(aM,o))&&r.push(aH)}return r}function ak(v,u,t,s,r,q,o){var n,m,d;if(u&&this.tagName.toLowerCase()!==u){return !1}if(t&&(n=t.match(aD))&&n[1]!==this.id){return !1}if(t&&(aI=t.match(aC))){for(aV=aI.length;aV--;){m=aI[aV].slice(1);if(!(ap.g(m)||ap.s(m,new RegExp("(^|\\s+)"+m+"(\\s+|$)"))).test(this.className)){return !1}}}if(s&&!o){aQ=this.attributes;for(d in aQ){if(Object.prototype.hasOwnProperty.call(aQ,d)&&(aQ[d].name||d)==r){return this}}}if(s&&!ah(q,this.getAttribute(r)||"",o)){return !1}return this}function al(b){return b.match(at)}function ar(b){aO=[];for(aV=0,aK=b.length;aV<aK;aV++){aO[aV]=b[aV]}return aO}var aW,aV,aU,aT,aS,aR,aQ,aP,aO,aN,aM,aL,aK,aJ,aI,aH,aG,aF,aE,aD=/#([\w\-]+)/,aC=/\.[\w\-]+/g,aB=/^#([\w\-]+$)/,aA=/^\.([\w\-]+)$/,az=/^([\w\-]+)$/,ay=/^([\w]+)?\.([\w\-]+)$/,ax=aX.documentElement,aw=/\s(?![\s\w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^'"]*\])/,av=/^([a-z0-9]+)?(?:([\.\#]+[\w\-\.#]+)?)/,au=/\[([\w\-]+)(?:([\|\^\$\*\~]?\=)['"]?([ \w\-\/\?\&\=\:\.\(\)\!,@#%<>\{\}\$\*\^]+)["']?)?\]/,at=new RegExp(av.source+"("+au.source+")?"),aq=function(){this.c={}};aq.prototype={g:function(b){return this.c[b]||undefined},s:function(d,c){this.c[d]=c;return c}};var ap=new aq,ao=new aq,an=new aq,am=new aq,af="compareDocumentPosition" in ax?function(d,c){return(c.compareDocumentPosition(d)&16)==16}:"contains" in ax?function(d,c){return c!==d&&c.contains(d)}:function(d,c){while(d=d.parentNode){if(d===c){return 1}}return 0},aa=function(){if(aX.querySelector&&aX.querySelectorAll){return ac}return function(s,r){var q=typeof r=="string"?aa(r)[0]:r||aX;if(!q||!s){return[]}var o,n,k=[],h=[],e;if(aR=ae(s,r,aa)){return aR}if(aR=s.match(ay)){aG=q.getElementsByTagName(aR[1]||"*"),aO=ap.g(aR[2])||ap.s(aR[2],new RegExp("(^|\\s+)"+aR[2]+"(\\s+|$)"));for(o=0,n=aG.length,aU=0;o<n;o++){aO.test(aG[o].className)&&(k[aU++]=aG[o])}return k}for(o=0,aG=s.split(","),n=aG.length;o<n;o++){h[o]=ag(aG[o])}for(o=0,n=h.length;o<n&&(aE=h[o]);o++){var b=aE;if(q!==aX){b=[];for(aU=0,aR=aE.length;aU<aR&&(e=aE[aU]);aU++){af(e,q)&&b.push(e)}}k=k.concat(b)}return ab(k)}}();aa.uniq=ab;var Z=aY.qwery;aa.noConflict=function(){aY.qwery=Z;return this},aY.qwery=aa}(this,document),snack.qwery=qwery.noConflict(),snack.wrap.defineEngine(function(d,c){return snack.qwery(d,c)});function showBubble(a,b){if(a!==undefined){constructBubble(a,b)}}function constructBubble(c,f){var h="";if(f=="online"){h=c.online_text}else{h=c.offline_text}var b=document.createElement("div");b.setAttribute("id","livilyChatButton");b.className="livilyChatButton";b.style.display="none";var a=glcpath+"/chat-offline2.png";b.innerHTML='<span id="chatWithWhom" style="display: block; font-size: 11px;font-weight:bold;padding-top:6px;"><span id="chat_Bubble" style="*margin-top:1px;width:17px;margin-right:3px;display: inline-block !important;vertical-align: middle;" class="cd-chat-'+f+'"></span><span id="spinner_bubble" style="margin:3px;display:none;" class="cd-chat-spinner"></span><span style="font-family:lucida grande, tahoma, verdana, arial, sans-serif;font-weight:bold;font-size:11px;vertical-align: middle;display: inline;" class="chat_Bubble" id="clickdesk_notification_text">'+h+'</span><span id="max-bubble" style="vertical-align: middle;display: inline-block !important; margin-right:3px;margin-left:3px;" class="cd-max"></span></span>';var e={cursor:"pointer",position:"fixed",backgroundColor:CLICKDESK_COLOR,bottom:"0px",overflow:"hidden",lineHeight:"1px",height:"30px",borderRadius:"5px 5px 0 0",MozBorderRadius:"5px 5px 0 0",WebkitBorderRadius:"5px 5px 0 0",KhtmlBorderRadius:"5px 5px 0 0",listStyle:"none",padding:"0px 0px 0px 5px",fontSize:"11px",textRendering:"optimizeLegibility",color:"#444",fontFamily:"lucida grande, tahoma, verdana, arial, sans-serif",zIndex:"2147483638",textAlign:"left"};var g=c.alignment;if(g=="bottom_right"){e.right="0px";e.marginRight="6px"}else{if(g=="bottom_left"){e.left="0px";e.marginLeft="6px"}else{if(g=="top_right"){e.top="0px";e.right="0px";e.marginRight="6px"}else{if(g=="top_left"){e.top="0px";e.left="0px";e.marginLeft="6px"}}}}e.color="#fff";e.enable=c.bubble_enabled;CLICKDESK_HIDE_OFFLINE=c.hide_offline;try{if(document.body!=null){document.body.appendChild(b)}}catch(d){clickdeskLog("document.body "+d)}setElementStyleByID("livilyChatButton",e);if(cd_ie_browser_version==6){setElementStyleByID("livilyChatButton",{width:h.length*6+30+"px"})}if(g=="top_right"||g=="top_left"){setElementStyleByID("livilyChatButton",{borderRadius:"0px 0px 5px 5px",MozBorderRadius:"0px 0px 5px 5px",WebkitBorderRadius:"0px 0px 5px 5px",KhtmlBorderRadius:"0px 0px 5px 5px"})}}function enableClickDeskBubble(){if(widgetPrefsJSON.bubble.bubble_enabled=="yes"){if(CLICKDESK_HIDE_OFFLINE=="yes"&&CLICKDESK_AGENT_STATUS=="offline"){setElementStyleByID("livilyChatButton",{display:"none"})}else{setElementStyleByID("livilyChatButton",{display:"block"})}}setElementStyleByID("livilyChatLink",{display:"inline"})}var cd_enable_button;function showButton(a){if(a!==undefined){constructButton(a)}}function constructButton(e){var q=e.position;var m=e.alignment;var l=widgetPrefsJSON.chat_window.color;if(l===undefined||l==null){l="gray"}cd_enable_button=e.button_enabled;var d=e.button_type;var a=document.createElement("div");a.setAttribute("id","livilytoolbarbutton");a.style.display="none";a.onmouseover=function(){buttonover(a)};a.onmouseout=function(){buttonout(a)};if(d===undefined||d=="type1"){a.className="livilytoolbarbutton livilyChatButton";var r;if(m=="right"||m=="left"){r=CLICKDESK_STATIC_AMAZON_IMAGE_URL+"/images/live-"+m+"-type1.png"}else{r=CLICKDESK_STATIC_AMAZON_IMAGE_URL+"/images/live-normal-type1.png"}var n={backgroundColor:l,backgroundImage:'url("'+r+'")',border:"1px solid #333",display:"none",position:"fixed",zIndex:"2147483638",cursor:"pointer"};var f={height:"34px",width:"100px",left:q};var g={height:"100px",width:"40px",top:q};if(m==="right"){n.right="-6px"}else{if(m==="left"){n.left="-6px"}else{if(m==="bottom"){n.bottom="-6px"}else{n.top="-6px"}}}try{if(document.body!=null){document.body.appendChild(a)}}catch(k){clickdeskLog("button "+k)}if(m=="right"||m=="left"){setElementStyleByID("livilytoolbarbutton",g)}else{setElementStyleByID("livilytoolbarbutton",f)}if(m=="top"){setElementStyleByID("livilytoolbarbutton",{borderRadius:"0px 0px 4px 4px",MozBorderRadius:"0px 0px 4px 4px",WebkitBorderRadius:"0px 0px 4px 4px",KhtmlBorderRadius:"0px 0px 4px 4px"})}else{if(m=="left"){setElementStyleByID("livilytoolbarbutton",{borderRadius:"0px 4px 4px 0px",MozBorderRadius:"0px 4px 4px 0px",WebkitBorderRadius:"0px 4px 4px 0px",KhtmlBorderRadius:"0px 4px 4px 0px"})}else{if(m=="right"){setElementStyleByID("livilytoolbarbutton",{borderRadius:"4px 0px 0px 4px",MozBorderRadius:"4px 0px 0px 4px",WebkitBorderRadius:"4px 0px 0px 4px",KhtmlBorderRadius:"4px 0px 0px 4px"})}else{setElementStyleByID("livilytoolbarbutton",{borderRadius:"4px 4px 0px 0px",MozBorderRadius:"4px 4px 0px 0px",WebkitBorderRadius:"4px 4px 0px 0px",KhtmlBorderRadius:"4px 4px 0px 0px"})}}}setElementStyleByID("livilytoolbarbutton",n)}else{a.className="livilybutton livilyChatButton";if(m=="right"||m=="left"){var j=CLICKDESK_STATIC_AMAZON_IMAGE_URL+"/images/live-chat-"+m+"-"+d+".png"}else{j=CLICKDESK_STATIC_AMAZON_IMAGE_URL+"/images/live-chat-normal-"+d+".png"}a.innerHTML="<img src="+j+" />";var b={backgroundColor:CLICKDESK_COLOR};var h={height:"33px",width:"94px",left:q};var o={height:"94px",top:q};if(m=="right"){b.right="-2px"}else{if(m=="left"){b.left="-2px"}else{if(m=="bottom"){b.bottom="-2px"}else{b.top="-2px"}}}try{if(document.body!=null){document.body.appendChild(a)}}catch(c){clickdeskLog("button "+c)}if(m=="right"||m=="left"){setElementStyleByID("livilytoolbarbutton",o);if(m=="right"){setElementStyleByID("livilytoolbarbutton",{borderRadius:"6px 0px 0px 6px",MozBorderRadius:"6px 0px 0px 6px",WebkitBorderRadius:"6px 0px 0px 6px",KhtmlBorderRadius:"6px 0px 0px 6px"})}}else{setElementStyleByID("livilytoolbarbutton",h);clickdeskElementWrap("#livilytoolbarbutton img")[0].style.margin="11px 10px 14px 14px !important";if(m=="top"){setElementStyleByID("livilytoolbarbutton",{borderRadius:"0px 0px 6px 6px",MozBorderRadius:"0px 0px 6px 6px",WebkitBorderRadius:"0px 0px 6px 6px",KhtmlBorderRadius:"0px 0px 6px 6px"})}else{setElementStyleByID("livilytoolbarbutton",{borderRadius:"6px 6px 0px 0px",MozBorderRadius:"6px 6px 0px 0px",WebkitBorderRadius:"6px 6px 0px 0px",KhtmlBorderRadius:"6px 6px 0px 0px"})}}setElementStyleByID("livilytoolbarbutton",b)}}function buttonover(b){var a=widgetPrefsJSON.button.alignment;switch(a){case"left":b.style.left=(parseInt(b.style.left)+1)+"px";break;case"right":b.style.right=(parseInt(b.style.right)+1)+"px";break;case"top":b.style.top=(parseInt(b.style.top)+1)+"px";break;case"bottom":b.style.bottom=(parseInt(b.style.bottom)+1)+"px";break;default:clickdeskLog("default");break}}function buttonout(b){var a=widgetPrefsJSON.button.alignment;switch(a){case"left":b.style.left=(parseInt(b.style.left)-1)+"px";break;case"right":b.style.right=(parseInt(b.style.right)-1)+"px";break;case"top":b.style.top=(parseInt(b.style.top)-1)+"px";break;case"bottom":b.style.bottom=(parseInt(b.style.bottom)-1)+"px";break;default:clickdeskLog("default2");break}}function showClickDeskButton(){if(widgetPrefsJSON.button.button_enabled=="yes"){if(cd_enable_button=="no"&&CLICKDESK_AGENT_STATUS=="offline"){setElementStyleByID("livilytoolbarbutton",{display:"none"})}else{setElementStyleByID("livilytoolbarbutton",{display:"block"})}}setElementStyleByID("livilyChatLink",{display:"inline"})}var CD_Live_Chat;var cd_proactive_message;var IS_PROACTIVE;var CLICKDESK_ONLINEFORM_CUSTOM_FIELD;var prechatCustom;var IS_CD_SSL=false;if(CLICKDESK_SERVER_PROTOCOL=="https://"){IS_CD_SSL=true}var cd_visitor_closed=false;function createClickDeskContainer(){var b=document.createElement("div");b.setAttribute("id","livechat_container");b.innerHTML='<div id="iframe_container" style="width:240px;bottom:0px;z-index:2147483638;"><div id="chat_container" style="width:235px;z-index:2147483638;"><div id="livechat_popup" style="position:fixed;bottom:0;width:235px;margin:0px 10px 0px 10px !important;z-index:2147483638;"><div id="livechat_controls" style="position: absolute;z-index: 20000078;right: 0px;width: 42px;"><img id="liveChat_close" title="Close" src="'+CLICKDESK_STATIC_AMAZON_IMAGE_URL+'/icons/new1.png" style="cursor: pointer;float:right;position: relative;background-color: #444;right:5px;top: 7px;" /><img id="liveChat_minimize" title="Minimize" src="'+CLICKDESK_STATIC_AMAZON_IMAGE_URL+'/icons/n2.png" style="cursor: pointer;float:right;position: relative;background-color: #444;right:8px;top: 7px;" /></div></div></div></div>';try{if(CLICKDESK_NO_SCRIPT_PAGE!==undefined){document.getElementById("wrapperDIV").appendChild(b)}}catch(a){document.body.appendChild(b)}setElementStyleByID("livechat_container",{bottom:"0px",display:"none",position:"fixed",zIndex:"2147483638"});var c=widgetPrefsJSON.bubble.alignment;if(c!==undefined&&c!=null){if(c==="bottom_right"||c==="top_right"){if(CLICKDESK_TEMPLATE=="cd_medium_template"||CLICKDESK_TEMPLATE=="cd_medium_image_template"){setElementStyleByID("livechat_popup",{right:"5px"})}else{setElementStyleByID("livechat_popup",{right:"0px"})}}else{if(c=="bottom_left"||c=="top_left"){setElementStyleByID("livechat_popup",{left:"0px"})}}}if(CLICKDESK_TEMPLATE=="cd_small_image_template"){setElementStyleByID("liveChat_minimize",{top:"31px"});setElementStyleByID("liveChat_close",{top:"31px"})}else{if(CLICKDESK_TEMPLATE=="cd_medium_image_template"){setElementStyleByID("liveChat_minimize",{top:"46px"});setElementStyleByID("liveChat_close",{top:"46px"})}}}function CLICKDESK_show(a){if(hasClass("livilyChatButton","loaded")){showClickDeskLiveChatPopup()}return CLICKDESK_cancelEvent(a)}function CLICKDESK_close(a){CLICKDESK_AGENT_NEW_MESSAGE=false;cd_visitor_closed=true;var c=document.getElementById("livechat_popup").offsetHeight;clickDeskSlideDOWN(c,clickDeskHide);try{clickdeskElementWrap(".livilyChatButton").removeClass("min");CLICKDESK_createCookie("active_popup","",-1);deleteSession()}catch(b){clickdeskLog("close"+b)}return CLICKDESK_cancelEvent(a)}function CLICKDESK_minimize(a){CLICKDESK_AGENT_NEW_MESSAGE=false;var c=document.getElementById("livechat_popup").offsetHeight;clickDeskSlideDOWN(c,clickDeskHide);try{clickdeskElementWrap(".livilyChatButton").addClass("min");CLICKDESK_createCookie("active_popup","",-1)}catch(b){clickdeskLog("minimize"+b)}return CLICKDESK_cancelEvent(a)}function clickDeskSlideUP(b,d){if(cd_ie_browser_version>5){d();return}var c=parseInt(b);var a=parseInt(document.getElementById("livechat_popup").style.bottom);if(parseInt(c)>0&&a<0){c=c-20;var a=parseInt(document.getElementById("livechat_popup").style.bottom);document.getElementById("livechat_popup").style.bottom=(a+20)+"px";setTimeout("clickDeskSlideUP("+c+","+d+")",20)}else{if(d!==undefined){d()}}}function clickDeskSlideDOWN(b,d){if(CLICKDESK_AGENT_NEW_MESSAGE){return}if(cd_ie_browser_version>5){d();return}var c=parseInt(b);if(c>0){c=c-20;var a=parseInt(document.getElementById("livechat_popup").style.bottom);document.getElementById("livechat_popup").style.bottom=(a-20)+"px";setTimeout("clickDeskSlideDOWN("+c+","+d+")",20)}else{if(d!==undefined){d()}}}function clickDeskHide(){setElementStyleByID("livechat_container",{display:"none"});enableClickDeskBubble();showClickDeskButton();setElementStyleByID("livilyChatLink",{display:"inline"})}function clickDeskShow(){clickdeskLog("clickDeskShow");setElementStyleByID("livechat_container",{display:"block"});setElementStyleByID("livechat_popup",{bottom:"0px"})}function CLICKDESK_cancelEvent(b){var a=b||window.event||{};a.cancelBubble=true;a.returnValue=false;a.stopPropagation&&a.stopPropagation();a.preventDefault&&a.preventDefault();return false}CD_Live_Chat={show:function(a){CLICKDESK_attempt(function(){return CLICKDESK_show(a)})},close:function(a){CLICKDESK_attempt(function(){return CLICKDESK_close(a)})},minimize:function(a){CLICKDESK_attempt(function(){return CLICKDESK_minimize(a)})}};function CLICKDESK_attempt(a){try{return a()}catch(b){clickdeskLog("LiveChat Error: ",b)}}cdloadCSS(glcpath+"css/screen.css");function createClickDeskPopup(K){var B=CLICKDESK_STATIC_AMAZON_IMAGE_URL+"/images/clickdesk-logo.png";var h="http://www.clickdesk.com/clickdesk-confirm.jsp?me="+CLICKDESK_USER_ID+"";var U=true;var C=widgetPrefsJSON.white_label_image_prefs;if(C!==undefined||C!=null){B=C.white_label_image_url;var j=C.white_label_image_url_link;if(j!==undefined){h=j}var J=C.whitelabel_image_option;if(J!==undefined&&J!=null){if(J=="whitelabel_default"){B=CLICKDESK_STATIC_AMAZON_IMAGE_URL+"/images/chat-logo.png";h="http://www.clickdesk.com/clickdesk-confirm.jsp?me="+CLICKDESK_USER_ID+""}else{if(J=="whitelabel_hide"){U=false}}}}B=(B);h=(h);var u=CLICKDESK_STATIC_AMAZON_IMAGE_URL+"/icons/message.png";if(CLICKDESK_COMPANY_LOGO===undefined||CLICKDESK_COMPANY_LOGO===null||CLICKDESK_COMPANY_LOGO.indexOf("images")==0){CLICKDESK_COMPANY_LOGO=CLICKDESK_STATIC_AMAZON_IMAGE_URL+"/images/agent.png"}else{CLICKDESK_COMPANY_LOGO=(CLICKDESK_COMPANY_LOGO)}var M=CLICKDESK_COMPANY_LOGO;var A=document.getElementById("livechat_popup");var F=createDOMElement("div","livilyheading","livilyheader_co");F.innerHTML='<img src="'+u+'" style="float:left;margin: 7px 5px 5px 5px;"/><h2 class="agent_name" style="font-size:124.7%;padding: 5px;color:#FFFFFF;margin:0px;font-family: arial,sans-serif;font-family:Trebuchet MS;line-height:1.6;font-weight:bold;">Live-Chat</h2></div>';var l=createDOMElement("div","livilytop","livilytop");l.innerHTML='<div class="livilyheader_co" style="float:left;width:28%;height:57px;border:none;-webkit-border-radius: 8px 8px 0px 0px;-moz-border-radius: 8px 8px 0px 0px;border-radius:8px 8px 0px 0px;-kthml-border-radius:8px 8px 0px 0px;"><p class="image"><img class="agent_image" src="'+M+'" width="54px" height="47px"/></p></div><div style="float:right;*float:left;width:72%;border:none;height:57px;"><div style="height:27px;"></div><div class="livilyheader_co" style="margin-left:-1px;height:30px;background-color:red;-webkit-border-radius: 0px 3px 0px 0px;-moz-border-radius: 0px 3px 0px 0px;border-radius:0px 3px 0px 0px;-kthml-border-radius:0px 3px 0px 0px;"></div></div>';var t=createDOMElement("div","prechatForm");t.innerHTML='<div id=\'prechatFormmessage\' style=\'padding: 2px;display: block;font-size: 11px;border: 1px solid #BBB;background: #EEE;color: #666;text-align: center;width:94%;margin: 5px 3px 3px 5px;\'> We\'re online! Please enter your name and email address to chat with our agents. </div><form style="font-size: 11px;padding-left:2px !important;margin: 10px 0px 0px 13px !important;font-family:Trebuchet MS;width:auto;" id="offline_form2" onsubmit="return false;"><div id="prechatFormname" style="font-size: 11px;">Name <small style="padding:0px;margin:0px;text-align:left;display:inline;font-size: 10px;">(optional)</small></div><div><input id="prechat_name" style="font-size: 12px;padding:0px 5px 0px 5px !important;outline-style: none;height:28px;*line-height:28px;margin:0px;width:190px;background: #FFF; "></div><div id="prechatFormemail" style="margin-top: 3px;font-size: 11px;">Email <small style="color: red;padding:0px;margin:0px;text-align:left;display:inline;font-size: 10px;">required</small></div><div><input id="prechat_email" style="font-size: 12px;padding:0px 5px 0px 5px !important;*line-height:28px;outline-style: none;height:28px;margin:0px;width:190px;background: #FFF;"></div><div id="prechatForminputmessage" style="font-size: 11px;margin-top: 3px;">Message <small style="color: red;padding:0px;margin:0px;text-align:left;display:inline;font-size: 10px;">required</small></div><div><input id="prechat_msg" style="font-size: 12px;height:30px;padding:0px 5px 0px 5px !important;*line-height:30px;resize: none; outline-style: none; display: block; width:190px; border-radius: 3px;-moz-border-radius: 3px;-webkit-border-radius: 3px;-khtml-border-radius: 3px;margin:0px;background: #FFF;" /></div><div> <small id="valid_email" style="font-size: 10px;color: red;visibility:hidden;padding:0px;margin:0px;text-align:left;">Please enter valid email.</small></div><div style="display:block;"><div class="livilyLargeSubmit livily_button_style" id="livily_prechat_button" align="center" style="display:inline-block;margin:0px;padding: 0px 4px !important;overflow: visible;width:auto;max-width:95%;height: 30px;font-size: 14px;cursor:pointer;font-family:Trebuchet MS;background: #ECE9DB;line-height: 1.6;"><div class="clickdesk_button_text" id="livily_prechat_button_text" style="margin:0px;font-size: 14px;cursor:pointer;font-family:Trebuchet MS;background: #ECE9DB;line-height: 1.6;padding-top: 3px !important;">Initiate chat</div></div><input type="button" id="prechat_button" value="Initiate chat" style="display:inline-block;margin:0px;padding: 0px 4px !important;overflow: visible;width:auto;max-width:95%;height: 30px;font-size: 14px;cursor:pointer;font-family:Trebuchet MS;background: #ECE9DB;line-height: 1.6;display:none!important;"/></div></form><div style=\'clear:both;\'></div><p class=\'powered\' style=\'margin-right:5px;margin-top:3px;text-align: right;margin-bottom: 0px;font-size:1.2em;width:100%;\'><a href=\''+h+"' target='_blank' style='text-decoration:none;font-size:12px;color: #444;margin-left: 3px;'><img style='display:inline;padding:0px;margin:0px;border:none;' src='"+B+"' /></a></p>";var w=createDOMElement("div","offlineForm");w.innerHTML='<div id=\'offlineFormmessage\' style=\'padding: 2px;display: block;font-size: 11px;border: 1px solid #BBB;background: #EEE;color: #666;margin: 5px 3px 3px 5px;text-align: center;width:94%;\'> </div><form style="width:auto;font-size: 11px;margin: 10px 0px 0px 13px !important;padding-left:2px !important;position:relative;font-family:Trebuchet MS;" id="offline_form" onsubmit="return false;"><div id="offlineFormname" style="font-size: 11px;"></div><div><input id="offline_name" style="padding:0px 5px 0px 5px !important;*line-height:28px;outline-style: none;height:28px;margin:0px;width:190px;font-size: 12px;background: #FFF; "></div><div id="offlineFormemail" style="font-size: 11px;"></div><div><input id="offline_email" style="padding:0px 5px 0px 5px !important;*line-height:28px;outline-style: none;height:28px;margin:0px;width:190px;font-size: 12px;background: #FFF;"></div><div id="offlineForminputmessage" style="font-size: 11px;"></div><div><textarea id="offline_msg" style="height:40px;padding:0px 5px 0px 5px !important;resize: none; outline-style: none; display: block; width:190px; overflow-y: auto; border-radius: 3px;-moz-border-radius: 3px;-webkit-border-radius: 3px;-khtml-border-radius: 3px;font-size: 12px;margin:0px;border: 1px solid #666;background: #FFF;" ></textarea></div><div style="display:block;margin-top: 6px !important;"><div class="livilyLargeSubmit livily_button_style" id="livily_offline_button" align="center" style="display:inline-block;margin:0px;padding: 0px 4px !important;overflow: visible;width:auto;max-width:95%;height: 30px;font-size: 14px;cursor:pointer;font-family:Trebuchet MS;background: #ECE9DB;line-height: 1.6;"><div class="clickdesk_button_text" id="livily_offline_button_text" style="margin:0px;overflow: visible;font-size: 14px;cursor:pointer;font-family:Trebuchet MS;background: #ECE9DB;line-height: 1.6;padding-top: 3px !important;">Initiate chat</div></div><input type="button" id="offline_button" value="Send Message" style="display:inline-block;margin:0px;margin-top:6px !important;padding: 0px 4px !important;overflow: visible;width:auto;max-width:95%;height: 30px;font-size: 14px;cursor:pointer;font-family:Trebuchet MS;background: #ECE9DB;line-height: 1.6;display:none!important;"/><span id="cd_loading" style="margin-left: 10px;display:none;">Submitting...</span></div><div> <small id="offline_valid_email" style="font-size: 10px;display:none;color: red;visibility:hidden;padding:0px;margin:0px;text-align:left;">Please enter valid email.</small></div></form><div style="clear:both;"></div><p class=\'powered\' style=\'margin-right:5px;margin-top:3px;text-align: right;margin-bottom: 0px;font-size:1.2em;width:100%;\'><a href=\''+h+"' target='_blank' style='font-size:12px;text-decoration:none;color: #444;margin-left: 3px;'><img style='padding:0px;margin:0px;border:none;display:inline;' src='"+B+"' /></a></p>";var y=createDOMElement("div","offlinethxmsg","offlinethxmsg");y.innerHTML='<div id="offlineFormsuccessmessage" style="padding: 1px;display: block;font-size: 17px;font-weight:bold;color: #666;text-align: center;margin: 10px 3px 3px 3px;width:95%;"><div align="center"><img src="'+CLICKDESK_STATIC_AMAZON_IMAGE_URL+'/images/emailed.png" width="100px" height="65px" style="margin-left:25%;" /></div><div style="margin-top:20px !important;text-align:left !important;font-size:17px !important;color:'+CLICKDESK_COLOR+"\" id=\"ClickdeskofflinethxMsgName\"></div><div style=\"margin-top:5px !important;font-size:17px !important;line-height:26px !important;text-align:center;\" id=\"ClickdeskofflineSucsMsg\">Thanks for dropping by.<br />We shall get to you soon.</div><br /></br/></div></div><p class='powered' id='loadingp' style='margin-right:5px;margin-top:3px;text-align: right;margin-bottom: 0px;font-size:1.2em;width:100%;position: absolute;right:5px;bottom:10px;'><a href='"+h+"' target='_blank' style='font-size:12px;text-decoration:none;color: #444;margin-left: 3px;'><img style='padding:0px;margin:0px;border:none;display:inline;' src='"+B+"' /></a></p>";var f=createDOMElement("div","clickdesk_new_message","clickdesk_new_message");f.innerHTML='<div style="font-size:13px;"><span style="float:right;font-size: 10px;visibility:hidden;color:black;margin-top:2px;" id="cd_date"></span><span id="cd_name" style="font-weight: bold;font-size: 13px;margin-left:-0.8em;color:#000;"></span><span id="cd_chat_msg" style="font-size: 13px; background: none;"></span></div>';var v=createDOMElement("div","cd_rewrite","cd_rewrite");v.innerHTML='<div style="font-size:13px;"><span id="cd_rewrite_msg" style="font-size:13px;"></span></div>';var k=createDOMElement("div","session","livilycontent");setElementStyleByObject(k,{display:"none",height:"175px",maxHeight:"180px",overflow:"auto",padding:"12px 4px 22px 10px","*fontSize":"90%",fontFamily:"Helvetica, Arial, sans-serif",textAlign:"left","word-wrap":"break-word"});var Q=createDOMElement("div","livily_twitter","livily_twitter");Q.innerHTML='<ul id="twitter_update_list"><li>Loading Tweets..</li></ul>';setElementStyleByObject(Q,{display:"none",width:"214px",minHeight:"160px",maxHeight:"180px",overflow:"auto",padding:"12px 4px 22px 10px","*fontSize":"90%",fontFamily:"Helvetica, Arial, sans-serif",textAlign:"left",backgroundColor:"#fff"});var m=createDOMElement("div","emailChatTsToVisitorForm");m.innerHTML='<div id=\'emailChatTsToVisitormessage\' style=\'padding: 2px;display: block;font-size: 11px;border: 1px solid #BBB;background: #EEE;color: #666;margin: 5px 3px 3px 5px;text-align: center;width:94%;\'>Please enter your name and email to receive this full chat transcript after closing the chat session. </div><form style="width:auto;font-size: 11px;margin: 10px 0px 0px 13px !important;padding-left:2px !important;position:relative;font-family:Trebuchet MS;" id="emailChatTsToVisitor_form" onsubmit="return false;"><div style=""><a style="margin:0px 10px 0px 0px;" id="cd_emailToVistitor_acl" onclick="return false;">ï¿½Cancel</a></div><div id="emailChatTsToVisitorFormname" style="font-size: 11px;">Name <small style="color:red;padding:0px;margin:0px;text-align:left;display:inline;font-size: 10px">(optional)</small></div><div><input id="emailChatTsToVisitor_name" style="padding:0px 5px 0px 5px !important;*line-height:28px;outline-style: none;height:28px;margin:0px;width:190px;font-size: 12px;background: #FFF; "></div><div id="emailChatTsToVisitorFormemail" style="font-size: 11px;margin-top:10px;">Email <small style="color:red;padding:0px;margin:0px;text-align:left;display:inline;font-size: 10px">(required)</small></div><div><input type="email" id="emailChatTsToVisitor_email" style="padding:0px 5px 0px 5px !important;*line-height:28px;outline-style: none;height:28px;margin:0px;width:190px;font-size: 12px;background: #FFF;"></div><div id="emailChatTsToVisitorFormError" style="display:none;color:red;">Please enter a valid Email Id</div><div style="clear:both;height:7px;"></div><div style="position:relative;height: 30px;margin-top: 5px;"><div class="livilyLargeSubmit livily_button_style" id="livily_etv_submit" align="center" style="display:inline;margin:0px;padding: 0px 4px !important;overflow: hidden;width:auto;max-width:95%;height: 30px;font-size: 14px;cursor:pointer;font-family:Trebuchet MS;background: #ECE9DB;line-height: 1.6;margin-left: 0px !important;"><div class="clickdesk_button_text" id="livily_etv_submit_text" style="margin:0px;overflow: visible;font-size: 14px;cursor:pointer;font-family:Trebuchet MS;background: #ECE9DB;line-height: 1.6;padding-top: 3px !important;">Initiate chat</div></div><div class="livilyLargeSubmit livily_button_style" id="livily_etv_cancel" align="center" style="display:inline;margin:0px;padding: 0px 4px !important;overflow: visible;width:auto;max-width:95%;height: 30px;font-size: 14px;cursor:pointer;font-family:Trebuchet MS;background: #ECE9DB;line-height: 1.6;display:none;"><div class="clickdesk_button_text" id="livily_etv_cancel_text" style="margin:0px;overflow: visible;font-size: 14px;cursor:pointer;font-family:Trebuchet MS;background: #ECE9DB;line-height: 1.6;padding-top: 3px !important;">Initiate chat</div></div></div><input type="submit" id="emailChatTsToVisitor_submit" value="Send" style="display:none!important;"/><input type="submit" id="emailChatTsToVisitor_cancel" value="Cancel" style="display:none!important"/><div style="clear:both;"></div><div id="sending_chattovisitor" style="margin:5px;font-weight:bold;"></div></form><div style="clear:both;"></div><p class=\'powered\' style=\'margin-right:5px;margin-top:3px;text-align: right;margin-bottom: 0px;font-size:1.2em;width:100%;position:absolute;bottom:10px;right:5px;\'><a href=\''+h+"' target='_blank' style='font-size:12px;text-decoration:none;color: #444;margin-left: 3px;'><img style='padding:0px;margin:0px;border:none;display:inline;' src='"+B+"' /></a></p>";var G=createDOMElement("div","livilyfooter","livilyfooter");G.innerHTML='<p class="link" id="callAgentOption" style="display:none;float:left;"><a id="callAgent" href="./"  onclick="return false;" style="margin: 3px 0; text-decoration: none;display:block;font-weight:bold;font-size:12px;font-family:Arial;"><img src="'+CLICKDESK_STATIC_AMAZON_IMAGE_URL+'/icons/chat-link.png" style="margin:-5px 5px 0px 0px;vertical-align:middle;*margin-top:0px;" />Call Agent</a></p><ul class="tools" id="livilyfooter_tools" style="float: right;margin-right: 0px !important;position: static;top: 7px;margin-bottom:1px !important;z-index:100;"><li class="print"><a href="./" style="visibility: hidden;" onclick="return false;">Print</a></li><li class="email" id="email_chat_transcript" style="cursor:pointer;"><a href="./" onclick="return false;">Email</a></li><li class="voice" id="voice" style="cursor:pointer;"><a href="./" onclick="return false;">Voice</a></li></ul><div style="clear:both;"></div><p style="padding:2px 0px 0px 0px;width:100%;"><form onsubmit="return sendClickDeskChatMessage();"><input type="text" id="broadcastchat" name="call" placeholder=" " style="outline-style: none;font-size: 13px;width: 200px;height: 33px;*line-height:33px;margin-top: 1px;padding:0px 5px 0px 8px !important;font-family: Helvetica, Arial, sans-serif;" /><button type="button" id="broadcastchatsend" style="top:9px;display: none!important;">Send</button></form></p><div style="position:relative;height:auto;"><ul class="social" id="livilyfooter_social" style="position:static;width:45px;margin:5px 0px 0px 0px !important;"><li class="twitter"><a href="#" style="visibility: hidden;position:relative;" target="_blank" id="livilyTwitter" rel="external">Twitter</a></li><li class="facebook"><a href="#" style="visibility: hidden;position:relative;" target="_blank" id="livilyfacebook" rel="external">Facebook</a></li></ul><p class=\'powered\' style=\'font-size:1.2em;margin:5px 0px 0px 0px;padding:0px;width:100%;*margin-top:-15px;\'><a href=\''+h+"' target='_blank' style='font-size:12px;text-decoration:none;color: #444;margin-left: 3px;'><img style='display:inline;padding:0px;margin:0px;border:none;' src='"+B+"' /></a></p></div>";var N=createDOMElement("span","playsound");A.appendChild(F);A.appendChild(l);A.appendChild(t);A.appendChild(w);A.appendChild(f);A.appendChild(v);A.appendChild(k);A.appendChild(m);A.appendChild(y);A.appendChild(Q);A.appendChild(G);A.appendChild(N);setElementStyleByID("livilyheading",{backgroundColor:"#3282BE",height:"30px",borderRadius:"5px 5px 0px 0px",MozBorderRadius:"5px 5px 0px 0px",WebkitBorderRadius:"5px 5px 0px 0px",KhtmlBorderRadius:"5px 5px 0px 0px",textAlign:"left",fontSize:"10px"});setElementStyleByID("livilytop",{display:"none",height:"57px",textAlign:"left"});setElementStyleByID("prechatForm",{display:"none",backgroundColor:"#fff",borderLeft:"1px solid #666",borderRight:"1px solid #666",borderBottom:"1px solid #ccc",textAlign:"left",padding:"5px 2px 10px 0px",position:"relative",zIndex:"10000"});setElementStyleByID("offlineForm",{display:"none",backgroundColor:"#fff",borderLeft:"1px solid #666",borderRight:"1px solid #666",borderBottom:"1px solid #ccc",textAlign:"left",padding:"5px 2px 10px 0px",position:"relative",zIndex:"10000"});setElementStyleByID("offlinethxmsg",{display:"none",backgroundColor:"#fff",borderLeft:"1px solid #666",borderRight:"1px solid #666",borderBottom:"1px solid #666",textAlign:"left",padding:"7px 2px 10px 0px",position:"relative",height:"270px"});setElementStyleByID("emailChatTsToVisitorForm",{display:"none",backgroundColor:"#fff",borderLeft:"1px solid #666",borderRight:"1px solid #666",borderBottom:"1px solid #666",textAlign:"left",padding:"5px 2px 10px 0px",position:"relative",zIndex:"1000",height:"270px"});setElementStyleByID("clickdesk_new_message",{display:"none",marginLeft:"7px",fontSize:"12px","word-wrap":"break-word"});setElementStyleByID("cd_rewrite",{display:"none",marginLeft:"-3px",fontSize:"12px"});setElementStyleByID("livilyfooter",{display:"none",paddingTop:"3px",paddingBottom:"9px",textAlign:"left",position:"relative",zIndex:"10000"});setElementStyleByID("playsound",{height:"0px",display:"none"});addCDBorder();var e=widgetPrefsJSON.customvalidationmssgs_prefs;if(e===undefined||e==null){WIDGET_CUSTOM_MESSAGES=(WIDGET_CUSTOM_MESSAGES);WIDGET_CUSTOM_MESSAGES=JSON.parse(WIDGET_CUSTOM_MESSAGES)}else{WIDGET_CUSTOM_MESSAGES=e}try{var O=WIDGET_CUSTOM_MESSAGES.customstatusmssgs_chat_window_label;if(O!==undefined&&O!=null){O=(O).replace(/&#39;/g,"'");CLICKDESK_CHAT_WINDOW_TITLE=O}clickdeskElementWrap(".agent_name")[0].innerHTML=CLICKDESK_CHAT_WINDOW_TITLE}catch(T){}if(!U){try{var I=clickdeskElementWrap("p.powered");for(var S=0;S<I.length;S++){var o=I[S];o.style.visibility="hidden"}}catch(T){}}try{var a=WIDGET_CUSTOM_MESSAGES.customstatusmssgs_chat_visitor_label;if(a!==undefined&&a!=null){a=(a).replace(/&#39;/g,"'");CLICKDESK_CHAT_AGENT_NAME=a}}catch(T){}try{var x=WIDGET_CUSTOM_MESSAGES.customstatusmssgs_chat_required_label;if(x!==undefined&&x!=null){x=(x).replace(/&#39;/g,"'");CLICKDESK_CHAT_REQUIRED_FIELD=x}}catch(T){}var z="",P="";try{var D=widgetPrefsJSON.user_phone;if(D!==undefined||D!=null){z=D.user_phone_type;P=D.user_phone_number}if(z!==undefined&&z!=null&&z.length>0&&P!==undefined&&P!=null&&P.length>0){appendCallUsTobody(P,z);clickdeskLog(D);showCallOption()}else{hideCallOption()}}catch(T){clickdeskLog(T)}var g=widgetPrefsJSON.offline_form_prefs;var d=widgetPrefsJSON.online_form_prefs;var E=widgetPrefsJSON.emailtovisitor_form_prefs;appendOfflineCustomFields(g);appendPrechatCustomFields(d);appendEmailToVisitorCustomFields(E);if(CLICKDESK_TWITTER_URL!==undefined&&CLICKDESK_TWITTER_URL!=null){if(widgetPrefsJSON.social_networks.show_twitter=="yes"){document.getElementById("livilyTwitter").href=CLICKDESK_TWITTER_URL;setElementStyleByID("livilyTwitter",{visibility:"visible"})}}if(CLICKDESK_FACEBOOK_URL!==undefined&&CLICKDESK_FACEBOOK_URL!=null){if(widgetPrefsJSON.social_networks.show_facebook=="yes"){document.getElementById("livilyfacebook").href=CLICKDESK_FACEBOOK_URL;setElementStyleByID("livilyfacebook",{visibility:"visible"})}}if(CLICKDESK_TEMPLATE=="cd_medium_template"){setElementStyleByID("iframe_container",{width:"280px"});setElementStyleByID("chat_container",{width:"280px"});setElementStyleByID("livechat_popup",{width:"280px"});setElementStyleByID("livilyheading",{height:"33px"});setElementStyleByObject(clickdeskElementWrap(".agent_name")[0],{padding:"8px"});setElementStyleByObject(clickdeskElementWrap("#livilyheading")[0].firstChild,{marginTop:"10px"});applyMediumTemplateCSS();var n=clickdeskElementWrap("div.livilycontent");snack.each(n,function(X){if(X.length!=0){setElementStyleByObject(X,{height:"202px",maxHeight:"202px"})}})}else{if(CLICKDESK_TEMPLATE=="cd_medium_image_template"){setElementStyleByID("iframe_container",{width:"280px"});setElementStyleByID("chat_container",{width:"280px"});setElementStyleByID("livechat_popup",{width:"280px"});clickdeskElementWrap("div.livilytop").addClass("mediumtop");var b=clickdeskElementWrap("div#livilytop")[0];setElementStyleByObject(b,{height:"75px"});setElementStyleByObject(b.firstChild,{height:"75px"});setElementStyleByObject(b.lastChild,{height:"75px"});var q=b.lastChild;setElementStyleByObject(q.firstChild,{height:"40px"});setElementStyleByObject(q.lastChild,{height:"35px"});var V=clickdeskElementWrap(".agent_image");snack.each(V,function(X){if(X.length!=0){setElementStyleByObject(X,{width:"65px",height:"60px"})}});applyMediumTemplateCSS();var n=clickdeskElementWrap("div.livilycontent");snack.each(n,function(X){if(X.length!=0){setElementStyleByObject(X,{height:"200px",maxHeight:"200px"})}})}}clickdeskElementWrap("div.livilyChatButton").addClass("loaded");cdinitializeOptions();var R=readSessionCookie("active_popup");try{if(CLICKDESK_NO_SCRIPT_PAGE!==undefined){R=true}}catch(T){}var L=getActiveSession();if(R!=null&&R!==undefined||(CLICKDESK_AGENT_STATUS=="online"&&(L!=null&&L!==undefined))){try{var c=document.getElementById("livilyChatButton");var s=document.getElementById("livilytoolbarbutton");var r=document.getElementById("livilyChatLink");if(isValidElement(c)||isValidElement(s)||isValidElement(r)){showLivechatPopup()}}catch(T){clickdeskLog("triggerclick"+T)}}else{if(CLICKDESK_PROACTIVE_JSON!=null&&CLICKDESK_PROACTIVE_JSON!==undefined&&CLICKDESK_AGENT_STATUS=="online"){try{var W=CLICKDESK_PROACTIVE_JSON.message;if(W!==undefined&&W!=null){var H=document.title;if(H===undefined||H==null){H=""}W=W.replace("$title",H).replace("$title",H).replace("$title",H);W=W.replace(/&#39;/g,"'").replace(/&#92;/g,'"');CLICKDESK_PROACTIVE_JSON.message=W}}catch(T){}clickdeskLog("checkSession(proactiveJSON)");CLICKDESK_TIME=setTimeout("checkSession(CLICKDESK_PROACTIVE_JSON);",parseInt(CLICKDESK_WAIT_TIME)*1000)}}if(K!==undefined){cdinitializeOptions();K()}}function showClickDeskLiveChatPopup(){clickdeskLog("showPopup");cd_visitor_closed=false;if(hasClass("livilyChatButton","min")){clickdeskLog("min");hideBubble();setElementStyleByID("livechat_container",{display:"block"});setElementStyleByID("livechat_popup",{bottom:"0px"})}else{clickdeskLog("checkSession");var a=clickdeskElementWrap("div.livilycontent");snack.each(a,function(b){if(b.length!=0){b.innerHTML=""}});checkSession()}}function loadServerJSFiles(c){var a=getActiveSession();var b=getPrefs(CD_CLIENT_DETAILS);if(IS_CD_SSL||a||b){loadServerMinifyJSFiles(c)}else{loadServerMinifyJSFiles(c)}}function loadServerMinifyJSFiles(a){loadJS(CLICKDESK_GOOGLE_API_JS,function(){enableClickDeskBubble();showClickDeskButton();createClickDeskPopup();cdCheckDoctypeInIE()})}function appendOfflineCustomFields(b){var c=OFFLINE_STATUS_LABEL,d=OFFLINE_NAME_LABEL,f=OFFLINE_EMAIL_LABEL,a=OFFLINE_MESSAGE_LABEL;var e=OFFLINE_BUTTON_VALUE;WIDGET_CUSTOM_MESSAGES.offline_send_success_label=OFFLINE_SEND_SUCCESS_MESSAGE;if(b!==undefined&&b!==null){if(b.offline_status_label!==undefined||b.offline_status_label!=null){c=(b.offline_status_label);c=c.replace(/&#39;/g,"'")}else{c=OFFLINE_STATUS_LABEL}if(b.offline_form_name_label!==undefined||b.offline_form_name_label!=null){d=(b.offline_form_name_label);d=d.replace(/&#39;/g,"'")}else{d=OFFLINE_NAME_LABEL}if(b.offline_form_email_label!==undefined||b.offline_form_email_label!=null){f=(b.offline_form_email_label);f=f.replace(/&#39;/g,"'")}else{f=OFFLINE_EMAIL_LABEL}if(b.offline_message_label!==undefined||b.offline_message_label!=null){a=(b.offline_message_label);a=a.replace(/&#39;/g,"'")}else{a=OFFLINE_MESSAGE_LABEL}if(b.offline_form_button_label!==undefined||b.offline_form_button_label!=null){e=(b.offline_form_button_label);e=e.replace(/&#39;/g,"'")}else{e=OFFLINE_BUTTON_VALUE}if(b.offline_send_success_label!==undefined){WIDGET_CUSTOM_MESSAGES.offline_send_success_label=b.offline_send_success_label}if(b.offline_emailvstext_label!==undefined||b.offline_emailvstext_label!=null){OFFLINE_FIRSTFIELDEMAILVSTEXT=b.offline_namefield_emailvstext_label}if(b.offline_emailvstext_label!==undefined||b.offline_emailvstext_label!=null){OFFLINE_SECONDFIELDEMAILVSTEXT=b.offline_emailvstext_label}}var g="Message sent successfully";document.getElementById("offline_name").setAttribute("name",d);document.getElementById("offline_email").setAttribute("name",f);document.getElementById("offline_msg").setAttribute("name",a);if(CLICKDESK_OFFLINEFORM_NAME){if(d.indexOf("required")==-1){d=d+" <small style='color:red;padding:0px;margin:0px;text-align:left;display:inline;font-size: 10px;'>("+CLICKDESK_CHAT_REQUIRED_FIELD+")</small>"}}if(CLICKDESK_OFFLINEFORM_EMAIL){if(f.indexOf("required")==-1){f=f+" <small style='color:red;padding:0px;margin:0px;text-align:left;display:inline;font-size: 10px'>("+CLICKDESK_CHAT_REQUIRED_FIELD+")</small>"}}if(a.indexOf("required")==-1){a=a+" <small style='color:red;padding:0px;margin:0px;text-align:left;display:inline;font-size: 10px;'>("+CLICKDESK_CHAT_REQUIRED_FIELD+")</small>"}document.getElementById("offlineFormmessage").innerHTML=c;document.getElementById("offlineFormname").innerHTML=d;document.getElementById("offlineFormemail").innerHTML=f;document.getElementById("offlineForminputmessage").innerHTML=a;document.getElementById("offline_button").value=e.replace(/&#34;/g,'"').replace(/&#92;/g,"\\");document.getElementById("livily_offline_button_text").innerHTML=e}function appendPrechatCustomFields(e){var a=PRECHAT_STATUS_LABEL,m=PRECHAT_NAME_LABEL,g=PRECHAT_EMAIL_LABEL,j=PRECHAT_MESSAGE_LABEL;var l=PRECHAT_BUTTON_VALUE;if(e!==undefined&&e!==null){if(e.prechat_status_label!==undefined||e.prechat_status_label!=null){a=(e.prechat_status_label);a=a.replace(/&#39;/g,"'")}else{a=PRECHAT_STATUS_LABEL}if(e.prechat_form_name_label!==undefined||e.prechat_form_name_label!=null){m=(e.prechat_form_name_label);m=m.replace(/&#39;/g,"'")}else{m=PRECHAT_NAME_LABEL}if(e.prechat_form_email_label!==undefined||e.prechat_form_email_label!=null){g=(e.prechat_form_email_label);g=g.replace(/&#39;/g,"'")}else{g=PRECHAT_EMAIL_LABEL}if(e.prechat_form_message_label!==undefined||e.prechat_form_message_label!=null){j=(e.prechat_form_message_label);j=j.replace(/&#39;/g,"'")}else{j=PRECHAT_MESSAGE_LABEL}if(e.prechat_form_button_label!==undefined||e.prechat_form_button_label!=null){l=(e.prechat_form_button_label);l=l.replace(/&#39;/g,"'")}else{l=PRECHAT_BUTTON_VALUE}if(e.prechat_namefield_emailvstext_label!==undefined||e.prechat_namefield_emailvstext_label!=null){PRECHAT_FIRSTFIELDEMAILVSTEXT=(e.prechat_namefield_emailvstext_label)}if(e.prechat_emailvstext_label!==undefined||e.prechat_emailvstext_label!=null){PRECHAT_SECONDFIELDEMAILVSTEXT=(e.prechat_emailvstext_label)}if(e.prechat_emailvstext_label!==undefined||e.prechat_emailvstext_label!=null){PRECHAT_CUSTOMFIELDEMAILVSTEXT=(e.prechat_customfield_emailvstext_label)}if(e.prechat_refill_form_fields!==undefined||e.prechat_refill_form_fields!=null){PRECHAT_REFILL_FORM_FILEDS=(e.prechat_refill_form_fields)}var b=e.prechat_form_show_custom_field_required;if(b!==undefined&&b=="yes"){CLICKDESK_ONLINEFORM_CUSTOM_FIELD="yes";if(e.prechat_form_custom_field_required!==undefined&&e.prechat_form_custom_field_required=="yes"){CLICKDESK_ONLINEFORM_CUSTOM_FIELD_REQUIRED=true}var k=e.prechat_form_custom_field_required;var f="";if(e.prechat_custom_field_label!==undefined){f=(e.prechat_custom_field_label);f=f.replace(/&#39;/g,"'")}var d=createDOMElement("div");if(k!==undefined&&k=="yes"){d.innerHTML='<div id="prechatFormcustom" style="margin-top: 3px;font-size: 11px;">'+f+' <small style="color: red;padding:0px;margin:0px;text-align:left;display:inline;font-size: 10px;">'+CLICKDESK_CHAT_REQUIRED_FIELD+'</small></div><div><input id="prechat_custom" style="font-size: 12px;padding:0px 5px 0px 5px !important;*line-height:28px;outline-style: none;height:28px;margin:0px;width:190px;background: #FFF;" /></div>'}else{d.innerHTML='<div id="prechatFormcustom" style="margin-top: 3px;font-size: 11px;">'+f+'</div><div><input id="prechat_custom" style="font-size: 12px;padding:0px 5px 0px 5px !important;*line-height:28px;outline-style: none;height:28px;margin:0px;width:190px;background: #FFF;" /></div>'}try{document.getElementById("offline_form2").insertBefore(d,document.getElementById("prechatForminputmessage"));document.getElementById("prechat_custom").setAttribute("name",f)}catch(c){clickdeskLog(c)}}}var h="Please enter valid email.";document.getElementById("prechat_name").setAttribute("name",m);document.getElementById("prechat_email").setAttribute("name",g);document.getElementById("prechat_msg").setAttribute("name",j);if(CLICKDESK_ONLINEFORM_NAME){if(m.indexOf("required")==-1){m=m+" <small style='color:red;padding:0px;margin:0px;text-align:left;display:inline;font-size:10px;'>("+CLICKDESK_CHAT_REQUIRED_FIELD+")</small>"}}if(CLICKDESK_ONLINEFORM_EMAIL){if(g.indexOf("required")==-1){g=g+" <small style='color:red;padding:0px;margin:0px;text-align:left;display:inline;font-size:10px;'>("+CLICKDESK_CHAT_REQUIRED_FIELD+")</small>"}}if(j.indexOf("required")==-1){j=j+" <small style='color:red;padding:0px;margin:0px;text-align:left;display:inline;font-size:10px;'>("+CLICKDESK_CHAT_REQUIRED_FIELD+")</small>"}document.getElementById("prechatFormmessage").innerHTML=a;document.getElementById("prechatFormname").innerHTML=m;document.getElementById("prechatFormemail").innerHTML=g;document.getElementById("prechatForminputmessage").innerHTML=j;document.getElementById("prechat_button").value=l.replace(/&#34;/g,'"').replace(/&#92;/g,"\\");document.getElementById("livily_prechat_button_text").innerHTML=l;document.getElementById("valid_email").innerHTML=h}function appendEmailToVisitorCustomFields(h){var c=EMAILTOVISITOR_STATUS_LABEL,b=EMAILTOVISITOR_NAME_LABEL,a=EMAILTOVISITOR_EMAIL_LABEL,d=EMAILTOVISITOR_SEND_BUTTON_VALUE,g=EMAILTOVISITOR_CANCEL_BUTTON_VALUE;if(h!==undefined&&h!==null){if(h.emailtovisitor_form_status_message_label!==undefined||h.emailtovisitor_form_status_message_label!=null){c=(h.emailtovisitor_form_status_message_label);c=c.replace(/&#39;/g,"'")}else{c=EMAILTOVISITOR_STATUS_LABEL}if(h.emailtovisitor_form_name_label!==undefined||h.emailtovisitor_form_name_label!=null){b=(h.emailtovisitor_form_name_label);b=b.replace(/&#39;/g,"'")}else{b=EMAILTOVISITOR_NAME_LABEL}if(h.emailtovisitor_form_email_label!==undefined||h.emailtovisitor_form_email_label!=null){a=(h.emailtovisitor_form_email_label);a=a.replace(/&#39;/g,"'")}else{a=EMAILTOVISITOR_EMAIL_LABEL}if(h.emailtovisitor_form_send_button_text!==undefined||h.emailtovisitor_form_send_button_text!=null){d=(h.emailtovisitor_form_send_button_text);d=d.replace(/&#39;/g,"'")}else{d=EMAILTOVISITOR_SEND_BUTTON_VALUE}if(h.emailtovisitor_form_cancel_button_text!==undefined||h.emailtovisitor_form_cancel_button_text!=null){g=(h.emailtovisitor_form_cancel_button_text);g=g.replace(/&#39;/g,"'")}else{g=EMAILTOVISITOR_CANCEL_BUTTON_VALUE}try{if(h.send_emailtovisitor_enabled!=undefined&&h.send_emailtovisitor_enabled=="no"){setElementStyleByID("email_chat_transcript",{display:"none"})}}catch(f){}}var e="Please enter valid email.";if(a.indexOf("required")==-1){a=a+" <small style='color:red;padding:0px;margin:0px;text-align:left;display:inline;font-size:10px;'>("+CLICKDESK_CHAT_REQUIRED_FIELD+")</small>"}if(b.indexOf("required")==-1){b=b+" <small style='color:red;padding:0px;margin:0px;text-align:left;display:inline;font-size: 10px;'></small>"}document.getElementById("emailChatTsToVisitormessage").innerHTML=c;document.getElementById("emailChatTsToVisitorFormname").innerHTML=b;document.getElementById("emailChatTsToVisitorFormemail").innerHTML=a;document.getElementById("emailChatTsToVisitor_submit").value=d.replace(/&#34;/g,'"').replace(/&#92;/g,"\\");document.getElementById("emailChatTsToVisitor_cancel").value=g.replace(/&#34;/g,'"').replace(/&#92;/g,"\\");document.getElementById("livily_etv_submit_text").innerHTML=d;document.getElementById("livily_etv_cancel_text").innerHTML=g;document.getElementById("cd_emailToVistitor_acl").innerHTML="<< "+g}function applyMediumTemplateCSS(){setElementStyleByID("offlineForm",{padding:"10px 4px 10px 5px"});setElementStyleByID("offlineFormmessage",{fontSize:"12px"});var c=clickdeskElementWrap("#offline_form2 div");for(var b=0;b<c.length;b++){setElementStyleByObject(c[b],{fontSize:"12px"})}var f=clickdeskElementWrap("#offline_form2 small");for(var b=0;b<f.length;b++){setElementStyleByObject(f[b],{fontSize:"12px"})}var j=clickdeskElementWrap("#offline_form2 input");for(var b=0;b<j.length;b++){setElementStyleByObject(j[b],{fontSize:"13px"})}setElementStyleByID("offlineFormemail",{marginTop:"5px"});setElementStyleByID("offlineForminputmessage",{marginTop:"5px"});setElementStyleByID("offline_name",{width:"235px",height:"33px",fontSize:"13px"});setElementStyleByID("offline_email",{width:"235px",height:"33px",fontSize:"13px"});setElementStyleByID("offline_msg",{width:"235px",height:"45px",fontSize:"13px"});setElementStyleByObject(clickdeskElementWrap("#prechatForm form")[0],{marginLeft:"10px"});setElementStyleByObject(clickdeskElementWrap("#offlineForm form")[0],{marginLeft:"10px"});setElementStyleByID("offlinethxmsg",{height:"335px"});var a=clickdeskElementWrap("#offline_form div");for(var b=0;b<a.length;b++){setElementStyleByObject(a[b],{fontSize:"12px"})}var e=clickdeskElementWrap("#offline_form small");for(var b=0;b<e.length;b++){setElementStyleByObject(e[b],{fontSize:"12px"})}var g=clickdeskElementWrap("#offline_form input");for(var b=0;b<g.length;b++){setElementStyleByObject(g[b],{fontSize:"13px"})}setElementStyleByID("prechatForm",{padding:"10px 4px 10px 5px"});setElementStyleByID("prechatFormmessage",{fontSize:"12px"});setElementStyleByID("offline_form2",{fontSize:"12px"});setElementStyleByID("prechatFormemail",{marginTop:"8px"});setElementStyleByID("prechatForminputmessage",{marginTop:"8px"});setElementStyleByID("prechat_name",{width:"235px",height:"31px",fontSize:"13px"});setElementStyleByID("prechat_email",{width:"235px",height:"31px",fontSize:"13px"});setElementStyleByID("prechat_msg",{width:"235px",height:"31px",fontSize:"13px"});setElementStyleByID("prechat_button",{height:"30px"});setElementStyleByID("broadcastchat",{fontSize:"14px",height:"33px",width:"94%"});setElementStyleByID("livilyfooter",{paddingTop:"5px"});setElementStyleByID("loadingp",{marginTop:"-10px"});var h=clickdeskElementWrap("#emailChatTsToVisitor_form input");for(var b=0;b<h.length;b++){if(h[b].type!="submit"&&h[b].type!="button"){setElementStyleByObject(h[b],{width:"235px",height:"31px",fontSize:"13px"})}else{setElementStyleByObject(h[b],{height:"30px"})}}var d=clickdeskElementWrap("#emailChatTsToVisitorForm div");for(var b=0;b<d.length;b++){setElementStyleByObject(d[b],{fontSize:"13px"})}setElementStyleByID("emailChatTsToVisitorForm",{height:"314px"});if(cd_ie_browser_version>5){setElementStyleByID("prechat_name",{"line-height":"31px"});setElementStyleByID("prechat_email",{"line-height":"31px"});setElementStyleByID("prechat_msg",{"line-height":"31px"});setElementStyleByID("offline_name",{"line-height":"31px"});setElementStyleByID("offline_email",{"line-height":"31px"});setElementStyleByID("offline_msg",{"line-height":"43px"});setElementStyleByID("broadcastchat",{"line-height":"33px"});var h=clickdeskElementWrap("#emailChatTsToVisitor_form input");for(var b=0;b<h.length;b++){if(h[b].type!="submit"&&h[b].type!="button"){setElementStyleByObject(h[b],{"line-height":"31px"})}}}}function isValidElement(a){if(a!=null&&a!==undefined){return true}else{return false}}function addCDBorder(){var b={borderLeft:"1px solid "+CLICKDESK_COLOR,borderRight:"1px solid "+CLICKDESK_COLOR,borderBottom:"1px solid "+CLICKDESK_COLOR};setElementStyleByID("prechatForm",b);setElementStyleByID("offlineForm",b);setElementStyleByID("livilyfooter",b);setElementStyleByID("session",b);setElementStyleByID("emailChatTsToVisitorForm",b);setElementStyleByID("livily_twitter",b);setElementStyleByID("livilyheading",{backgroundColor:CLICKDESK_COLOR});var c=clickdeskElementWrap("div.livilyheader_co");for(var a=0;a<c.length;a++){c[a].style.backgroundColor=CLICKDESK_COLOR}}var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(d){for(var a=0;a<d.length;a++){var b=d[a].string;var c=d[a].prop;this.versionSearchString=d[a].versionSearch||d[a].identity;if(b){if(b.indexOf(d[a].subString)!=-1){return d[a].identity}}else{if(c){return d[a].identity}}}},searchVersion:function(b){var a=b.indexOf(this.versionSearchString);if(a==-1){return}return parseFloat(b.substring(a+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();var FlashDetect=new function(){var a=this;a.installed=false;a.raw="";a.major=-1;a.minor=-1;a.revision=-1;a.revisionStr="";var b=[{name:"ShockwaveFlash.ShockwaveFlash.7",version:function(h){return d(h)}},{name:"ShockwaveFlash.ShockwaveFlash.6",version:function(k){var h="6,0,21";try{k.AllowScriptAccess="always";h=d(k)}catch(j){}return h}},{name:"ShockwaveFlash.ShockwaveFlash",version:function(h){return d(h)}}];var d=function(k){var h=-1;try{h=k.GetVariable("$version")}catch(j){}return h};var g=function(h){var k=-1;try{k=new ActiveXObject(h)}catch(j){k={activeXError:true}}return k};var c=function(j){var h=j.split(",");return{raw:j,major:parseInt(h[0].split(" ")[1],10),minor:parseInt(h[1],10),revision:parseInt(h[2],10),revisionStr:h[2]}};var f=function(l){var j=l.split(/ +/);var k=j[2].split(/\./);var h=j[3];return{raw:l,major:parseInt(k[0],10),minor:parseInt(k[1],10),revisionStr:h,revision:e(h)}};var e=function(h){return parseInt(h.replace(/[a-zA-Z]/g,""),10)||a.revision};a.majorAtLeast=function(h){return a.major>=h};a.minorAtLeast=function(h){return a.minor>=h};a.revisionAtLeast=function(h){return a.revision>=h};a.versionAtLeast=function(j){var k=[a.major,a.minor,a.revision];var h=Math.min(k.length,arguments.length);for(i=0;i<h;i++){if(k[i]>=arguments[i]){if(i+1<h&&k[i]==arguments[i]){continue}else{return true}}else{return false}}};a.FlashDetect=function(){if(navigator.plugins&&navigator.plugins.length>0){var l="application/x-shockwave-flash";var k=navigator.mimeTypes;if(k&&k[l]&&k[l].enabledPlugin&&k[l].enabledPlugin.description){var h=k[l].enabledPlugin.description;var m=f(h);a.raw=m.raw;a.major=m.major;a.minor=m.minor;a.revisionStr=m.revisionStr;a.revision=m.revision;a.installed=true}}else{if(navigator.appVersion.indexOf("Mac")==-1&&window.execScript){var h=-1;for(var j=0;j<b.length&&h==-1;j++){var n=g(b[j].name);if(!n.activeXError){a.installed=true;h=b[j].version(n);if(h!=-1){var m=c(h);a.raw=m.raw;a.major=m.major;a.minor=m.minor;a.revision=m.revision;a.revisionStr=m.revisionStr}}}}}}()};FlashDetect.JS_RELEASE="1.0.4";var WIDGET_PREFERENCE_DB_NAME="widget_prefs";var BUBBLE_PREFERENCES="bubble";var BUTTON_PREFERENCES="button";var SESSION_COOKIE_NAME="active_session";var SESSION_ID="session_id";var SESSION_HISTORY="session_history";var SESSION_VISITOR="visitor_token";var CD_CLIENT_DETAILS="cd_client_details";var VISITOR_BLOCK_PERIOD=30;var CHANNEL_ID="channel_id";var ARCHIVE_SESSION="archive_session_id";var ARCHIVE_SESSION_PERIOD=180;var CLICKDESK_AGENT_NICK_NAME;var CLICKDESK_AGENT_IMAGE_DEFAULT_URL;var sound=true;var VISITOR_EMAIL="visitor_email";var VISITOR_NAME="visitor_name";var agentId=undefined;var visitorToken;var sessionId=undefined;var visitorEmail;var visitorName;var livilyPhone;var chat_link_livily;var toolbar_button_livily;var chat_button_livily;var numberToCall;var callType;var CLICKDESK_AGENT_NEW_MESSAGE=false;var CLICKDESK_VISITOR="visitor";var WIDGET_CUSTOM_MESSAGES='{"customstatusmssgs_send_success_mssg_label": "We have saved your preferences","customstatusmssgs_agent_exceeded_time_label": "It seems to be taking longer than usual. You can continue to be on hold or leave us an offline message.","customstatusmssgs_nosession_label": "You have no active chat session at this time.","customstatusmssgs_wait_input_field_status_label": "Please wait...","customstatusmssgs_send_request_label": "Sending...","customstatusmssgs_message_field_label": "Enter your message to chat","customstatusmssgs_name_field_label": "Please fill the required fields.","customstatusmssgs_wait_status_label": "Please wait while we connect you to an available agent...","customstatusmssgs_email_field_label": "Enter the valid email address.","customstatusmssgs_send_failure_mssg_label": "Sending failed.Please try again..."}';var PRECHAT_STATUS_LABEL="Please enter your name and email address to begin chatting with us.";var PRECHAT_NAME_LABEL="Name";var PRECHAT_EMAIL_LABEL="Email";var PRECHAT_CUSTOM_LABEL="Custom";var PRECHAT_MESSAGE_LABEL="Message";var PRECHAT_BUTTON_VALUE="Initiate Chat.";var PRECHAT_FIRSTFIELDEMAILVSTEXT="text";var PRECHAT_SECONDFIELDEMAILVSTEXT="email";var PRECHAT_CUSTOMFIELDEMAILVSTEXT="text";var CLICKDESK_ONLINEFORM_CUSTOM_FIELD_REQUIRED=false;var PRECHAT_REFILL_FORM_FILEDS="no";var OFFLINE_STATUS_LABEL="Please leave your name and email address, we will get back to you soon. Thanks.";var OFFLINE_NAME_LABEL="Name";var OFFLINE_EMAIL_LABEL="Email";var OFFLINE_MESSAGE_LABEL="Message";var OFFLINE_BUTTON_VALUE="Send Message";var OFFLINE_SEND_SUCCESS_MESSAGE="Thanks for dropping by.<br/>We shall get back to you soon.";var OFFLINE_FIRSTFIELDEMAILVSTEXT="text";var OFFLINE_SECONDFIELDEMAILVSTEXT="email";var EMAILTOVISITOR_STATUS_LABEL="Please enter your name and email to receive this full chat transcript after closing the chat session.";var EMAILTOVISITOR_NAME_LABEL="Name";var EMAILTOVISITOR_EMAIL_LABEL="Email";var EMAILTOVISITOR_SEND_BUTTON_VALUE="Send";var EMAILTOVISITOR_CANCEL_BUTTON_VALUE="Cancel";var CLICKDESK_CHAT_WINDOW_TITLE="Live-Chat";var CLICKDESK_CHAT_AGENT_NAME="me";var CLICKDESK_CHAT_REQUIRED_FIELD="required";var CLICKDESK_REFERRER="clickdesk_referrer";var PROACTIVE_SESSION_COOKIE="proactive_session_cookie";var CLICKDESK_STATIC_AMAZON_IMAGE_URL="//d25wh3ilibgxb0.cloudfront.net";var CHANNELSOCKET;function connectToServer(c){var a={};a.command="new_token";a.widget_id=CLICKDESK_WIDGET_ID;LivilyLog("Connecting to server for token and channel id");var b=constructSnackRequest(a,CLICKDESK_SERVER_PATH+"/visitor");snack.JSONP(b,function(f){var d=f.response;if(d!=undefined&&d!=null){LivilyLog(d);visitorToken=d.visitor_token;LivilyLog("Visitor Token "+visitorToken);var e=d.channel_id;establishChannel(e,c)}})}function establishChannel(c,d){LivilyLog("Establishing Channel "+c);setPrefs(CHANNEL_ID,c);onOpened=function(){LivilyLog("onOpened channel = "+c);LivilyLog("Channel opened "+c);if(d!==undefined){d(visitorToken)}};onMessage=function(e){var f=JSON.parse(e.data);LivilyLog(JSON.stringify(f));messageReceived(f)};onError=function(){LivilyLog("error in channel")};onClose=function(){LivilyLog("onClose close")};try{var a=new goog.appengine.Channel(c);CHANNELSOCKET=a.open();CHANNELSOCKET.onopen=onOpened;CHANNELSOCKET.onmessage=onMessage;CHANNELSOCKET.onerror=onError;CHANNELSOCKET.onclose=onClose}catch(b){console.log("channel creation = "+b)}}function getPrefs(a,c,d,g,f,e){LivilyLog("Reading "+a+" from cookie.");var b=CLICKDESK_readCookie(a);if(b==null){LivilyLog("Cookie not found "+a)}return b}function setPrefs(a,b,c){CLICKDESK_createCookie(a,b,c)}function deletePrefs(a){CLICKDESK_eraseCookie(a)}function CLICKDESK_createCookie(c,d,e){c=CLICKDESK_WIDGET_ID+"-"+c;if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+escape(d)+a+"; path=/"}function CLICKDESK_readCookie(b){b=CLICKDESK_WIDGET_ID+"-"+b;var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return unescape(f.substring(e.length,f.length))}}return null}function CLICKDESK_eraseCookie(a){CLICKDESK_createCookie(a,"",-1)}function checkProactive(){var a=getUrlVars()["url"];var b={};b.command="get_proactive_message";b.url=a;b.widget_id=CLICKDESK_WIDGET_ID;var c=constructSnackRequest(b,CLICKDESK_SERVER_PATH+"/visitor");snack.JSONP(c,function(e){console.log(e);var d=JSON.parse(e);console.log(d);if(d.status=="success"){var f=d.response;appendMessage(f.message)}LivilyLog("Text sent "+d)})}function getActiveSession(){var a=getPrefs(SESSION_COOKIE_NAME);if(a){return JSON.parse(a)}return null}function checkSession(proactiveMessage){clickdeskLog("Checking session");var sessionJSON=getActiveSession();clickdeskLog(sessionJSON);if(sessionJSON){var sessionId=eval("sessionJSON."+SESSION_ID);if(sessionId!=undefined){var channel=getPrefs(CHANNEL_ID);if(channel!=null){establishChannel(channel);clickdeskLog("establishChannel")}enableChatButton();showChatBox();showClickDeskChatLoading();var json={};json.command="validate_session";json.session_id=sessionId;json.visitor_url=window.location.href;var params=constructSnackRequest(json,CLICKDESK_SERVER_PATH+"/visitor");snack.JSONP(params,function(response){LivilyLog("Session Response");LivilyLog(response);hideClickDeskChatLoading();if(response.status!="success"){LivilyLog(response.errormssg);LivilyLog("Deleting old session values");document.getElementById("session").innerHTML="";deletePrefs(SESSION_COOKIE_NAME);deletePrefs(CHANNEL_ID);deletePrefs(VISITOR_EMAIL);showPrechatForm()}else{LivilyLog("Session valid at server");clickdeskLog(response);var agentJSON=response.response.agent;var archiveMessagesJSON=response.response.archive;clickdeskLog(agentJSON);if(agentJSON!==undefined&&agentJSON!=null){CLICKDESK_AGENT_NICK_NAME=agentJSON.nick_name;CLICKDESK_AGENT_IMAGE_DEFAULT_URL=agentJSON.img_url;if(IS_CD_SSL){CLICKDESK_AGENT_IMAGE_DEFAULT_URL=CLICKDESK_AGENT_IMAGE_DEFAULT_URL.replace("http://",CLICKDESK_SERVER_PROTOCOL)}var numberToCall=agentJSON.phone_number;var callType=agentJSON.phone_type;if(numberToCall!==undefined&&numberToCall!==null&&callType!==undefined&&callType!==null&&callType.length>0&&numberToCall.length>0){appendCallUsTobody(numberToCall,callType);showCallOption()}}else{CLICKDESK_AGENT_NICK_NAME=CLICKDESK_CHAT_WINDOW_TITLE;CLICKDESK_AGENT_IMAGE_DEFAULT_URL=CLICKDESK_COMPANY_LOGO}if(archiveMessagesJSON!=null||archiveMessagesJSON!==undefined){initWindow(archiveMessagesJSON)}if(CLICKDESK_AGENT_NICK_NAME!==undefined||CLICKDESK_AGENT_IMAGE_DEFAULT_URL!==undefined){var upperNickName=CLICKDESK_AGENT_NICK_NAME.slice(0,1).toUpperCase()+CLICKDESK_AGENT_NICK_NAME.slice(1);setagentNameandimage(upperNickName,CLICKDESK_AGENT_IMAGE_DEFAULT_URL)}else{clickdeskLog("Cannot find channel id")}}})}else{showPrechatForm()}}else{if(CLICKDESK_AGENT_STATUS=="offline"){showOfflineForm()}else{if(proactiveMessage!==undefined&&CLICKDESK_AGENT_STATUS=="online"){try{var livilycontent=clickdeskElementWrap(".livilycontent");snack.each(livilycontent,function(eachElement){if(eachElement.length!=0){eachElement.innerHTML=""}});enableChatButton();CLICKDESK_createCookie(PROACTIVE_SESSION_COOKIE,PROACTIVE_SESSION_COOKIE);try{if(CLICKDESK_PROACTIVE_SOUND=="yes"){playSendSound()}}catch(err){}appendMessage(unescape(proactiveMessage.message),"srvstaticmsg");showChatBox()}catch(err){clickdeskLog("err"+err)}}else{showPrechatForm()}}}return}function initBroadcastSession(b,a){connectToServer(function(u){var s={};s.command="new_chat_broadcast_message";var t=CLICKDESK_readCookie(PROACTIVE_SESSION_COOKIE);if(t!==undefined&&t!=null){s.proactive_chat="proactive"}if(a===undefined){s.proactive_chat="proactive";if(CLICKDESK_PROACTIVE_JSON!==undefined&&CLICKDESK_PROACTIVE_JSON!=null){s.user_proactive_message=CLICKDESK_PROACTIVE_JSON.message}}s.visitor_token=u;s.user_message=b;s.visitor_info=getVisitorInfo();s.widget_id=CLICKDESK_WIDGET_ID;var q=new Array();var r=CLICKDESK_readCookie("visitor_email");var d=CLICKDESK_readCookie("visitor_name");var e=PRECHAT_NAME_LABEL;var c=PRECHAT_EMAIL_LABEL;var o=PRECHAT_CUSTOM_LABEL;var l=widgetPrefsJSON.online_form_prefs;if(l!==undefined&&l!==null){if(l.prechat_form_name_label!==undefined||l.prechat_form_name_label!=null){e=(l.prechat_form_name_label)}if(l.prechat_form_email_label!==undefined||l.prechat_form_email_label!=null){c=(l.prechat_form_email_label)}if(l.prechat_custom_field_label!==undefined||l.prechat_form_email_label!=null){o=(l.prechat_custom_field_label)}}if(d!==undefined&&d!=null){s.visitor_name=d;var k={};k.fieldName=e;k.fieldValue=d;q.push(k)}if(r!==undefined&&r!=null){s.visitor_email=r;var j={};j.fieldName=c;j.fieldValue=r;q.push(j)}if(prechatCustom!==undefined&&prechatCustom!=null){s.custom_data=prechatCustom;var f={};f.fieldName=o;f.fieldValue=prechatCustom;q.push(f)}try{var n="[";for(var m=0;m<q.length;m++){if(m!=(q.length-1)){n=n+JSON.stringify(q[m])+","}else{n=n+JSON.stringify(q[m])}}n=n+"]";s.prechat_fields=n}catch(h){}var g=constructSnackRequest(s,CLICKDESK_SERVER_PATH+"/visitor");snack.JSONP(g,function(v){LivilyLog("Old session "+v);if(v.response!=undefined){v=v.response;enableChatButton();document.getElementById("broadcastchat").value="";cdSetFocus();clearTimeout(CLICKDESK_SESSION_TIMEOUT);LivilyLog(v)}handleBroadcast(v)})})}function handleBroadcast(b){clickdeskLog(b.status);if(b.status!=undefined&&b.status=="success"){var a=b.response.broadcast_id;setSessionId(a,visitorToken)}if(b.status!=undefined&&b.status=="error"){var c=b.errormssg;clickdeskLog(c);appendMessage(c,"srvstaticmsg");clickdeskLog(CHANNELSOCKET);if(CHANNELSOCKET!==undefined){try{CHANNELSOCKET.close()}catch(d){clickdeskLog(d)}}}}function handleProactive(a){IS_PROACTIVE=false;if(a.status!=undefined&&a.status=="error"){var b=a.errormssg;clickdeskLog(b)}}function initProactiveSession(b,a){connectToServer(function(c){var d={};d.command="new_chat_proactive_message";d.visitor_token=c;d.agent_id=b;d.user_message=a;d.visitor_info=getVisitorInfo();d.widget_id=CLICKDESK_WIDGET_ID;if(visitorName!==undefined){d.visitor_name=visitorName}if(visitorEmail!==undefined){d.visitor_email=visitorEmail}var e=constructSnackRequest(d,CLICKDESK_SERVER_PATH+"/visitor");snack.JSONP(e,function(f){f=f.response;LivilyLog(f);sessionId=f.id;clickdeskLog("SessionId "+sessionId);setSessionId(sessionId,c)})})}function messageReceived(j){clickdeskLog(j);CLICKDESK_AGENT_NEW_MESSAGE=false;enableChatButton();try{removeElement("session","cd_remove")}catch(r){}clearTimeout(CLICKDESK_SESSION_TIMEOUT);var l=j.message_type;var k=getActiveSession();if(l!="session_closed"&&k!=null){CLICKDESK_AGENT_NEW_MESSAGE=true;clickDeskAutoPopup()}if(l=="accepted_chat_message"){var k=j.session_details;document.getElementById("broadcastchat").removeAttribute("disabled");try{var a=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_wait_input_field_status_label.replace(/&#39;/g,"'"));if(document.getElementById("broadcastchat").value===a){document.getElementById("broadcastchat").value=""}}catch(c){}var n=j.agent_details;clickdeskLog(n);clickdeskLog("Agent accepted our chat. Congrats."+k+" "+n);clickdeskLog("number = "+n.phone_number);clickdeskLog("type = "+n.phone_type);var s=n.phone_number;var u=n.phone_type;if(s!==undefined&&s!=null&&u!==undefined&&u!=null&&u.length>0&&s.length>0){appendCallUsTobody(s,u);showCallOption()}clickdeskLog(k);var q=k.id;var o=k.visitor_token;setSessionId(q,o);CLICKDESK_AGENT_NICK_NAME=n.nick_name;var m=CLICKDESK_AGENT_NICK_NAME.slice(0,1).toUpperCase()+CLICKDESK_AGENT_NICK_NAME.slice(1);CLICKDESK_AGENT_IMAGE_DEFAULT_URL=n.img_url;if(IS_CD_SSL){CLICKDESK_AGENT_IMAGE_DEFAULT_URL=CLICKDESK_AGENT_IMAGE_DEFAULT_URL.replace("http://",CLICKDESK_SERVER_PROTOCOL)}setagentNameandimage(m,CLICKDESK_AGENT_IMAGE_DEFAULT_URL);try{cdSetFocus()}catch(c){}}else{if(l=="new_chat_message"){var h=j.new_chat_message;if(h.charAt(0)=="["){appendMessage(h,"srvstaticmsg")}else{appendMessage(h,CLICKDESK_AGENT_NICK_NAME)}if(sound){playRecvSound()}try{blinkTitle(h,20)}catch(c){clickdeskLog("title ="+c)}cdSetFocus()}else{if(l=="block_chat"){var g=j.block_ip;setPrefs(VISITOR_BLOCK,g,VISITOR_BLOCK_PERIOD);IS_VISITOR_BLOCK=true;appendMessage("[Your IP has been blocked by Agent]","srvstaticmsg");document.getElementById("broadcastchatsend").setAttribute("disabled",true);try{hideCallOption()}catch(r){}}else{if(l=="session_closed"){try{clickdeskLog("Session Closed.");CHANNELSOCKET.close();CLICKDESK_eraseCookie(PROACTIVE_SESSION_COOKIE);var m=CLICKDESK_CHAT_WINDOW_TITLE;var b=CLICKDESK_COMPANY_LOGO;setagentNameandimage(m,b);deletePrefs(SESSION_COOKIE_NAME);deletePrefs(CHANNEL_ID);var f="",t="";try{var d=widgetPrefsJSON.user_phone;if(d!==undefined||d!=null){f=d.user_phone_type;t=d.user_phone_number}if(f!==undefined&&f!=null&&f.length>0&&t!==undefined&&t!=null&&t.length>0){appendCallUsTobody(t,f);clickdeskLog(d);showCallOption()}else{hideCallOption()}}catch(c){clickdeskLog(c)}}catch(c){clickdeskLog("session_closed ="+c)}}else{appendMessage(JSON.stringify(j))}}}}}function sendMessage(message,name,chatType){if(!IS_VISITOR_BLOCK){var sessionJSON=getActiveSession();if(sessionJSON==null){document.getElementById("broadcastchat").value="";appendMessage(message,name);if(sound){playSendSound()}disableChatButton();initBroadcastSession(message,chatType);CLICKDESK_SESSION_TIMEOUT=setTimeout("showOfflineLink();",60000)}else{var sessionId=eval("sessionJSON."+SESSION_ID);if(sessionId.indexOf("BD")==0){return false}removeElement("session","cd_remove");document.getElementById("broadcastchat").value="";appendMessage(message,name);cdSetFocus();if(sound){playSendSound()}var json={};json.command="new_chat_message";json.session_id=sessionId;json.user_message=message;var params=constructSnackRequest(json,CLICKDESK_SERVER_PATH+"/visitor");snack.JSONP(params,function(response){LivilyLog("Text sent "+message)});cdSetFocus()}}else{appendMessage("[Your IP has been blocked by Agent]","srvstaticmsg");document.getElementById("broadcastchatsend").setAttribute("disabled",true)}}function setSessionId(d,a){var c={};c.session_id=d;c.visitor_token=a;setPrefs(SESSION_COOKIE_NAME,JSON.stringify(c));if(d.indexOf("BD")!=0){var b=getPrefs(ARCHIVE_SESSION);if(b==null||b===undefined||b.split(",").length>=35){b=d}else{b+=(", "+d)}setPrefs(ARCHIVE_SESSION,b,ARCHIVE_SESSION_PERIOD)}}function setHistory(b){var c=getPrefs(SESSION_COOKIE_NAME);if(c!=null){var a=JSON.parse(c);a.session_history=b;setPrefs(SESSION_COOKIE_NAME,JSON.stringify(a))}}function disableChatButton(){try{document.getElementById("broadcastchatsend").setAttribute("disabled",true);var c=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_wait_status_label).replace(/&#39;/g,"'");var b=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_wait_input_field_status_label).replace(/&#39;/g,"'");if(c!==undefined&&c!==null){document.getElementById("broadcastchat").setAttribute("disabled",true);document.getElementById("broadcastchat").value="";document.getElementById("broadcastchat").style.backgroundColor="#EEE"}if(b!==undefined&&b!==null){removeElement("session","cd_remove");var f=document.getElementById("cd_rewrite").cloneNode(true);f.id="";f.className="cd_remove";cdAppendData(f,"cd_rewrite_msg",c);setElementStyleByObject(f,{display:"block",fontStyle:"italic"});document.getElementById("session").appendChild(f);var e=widgetPrefsJSON.plan_type;if(e!=undefined&&e!=null&&(e=="free"||e.indexOf("Lite")!=-1)){var g=document.getElementById("cd_rewrite").cloneNode(true);g.id="";g.className="";cdAppendData(g,"cd_rewrite_msg",'This chat is powered by ClickDesk. Click here <a href="http://www.clickdesk.com" class="cd_hyperlink" target="_blank">http://www.clickdesk.com</a>');setElementStyleByObject(g,{display:"block",fontStyle:"italic","margin-top":"5px","margin-bottom":"5px"});document.getElementById("session").appendChild(g)}}var a=clickdeskElementWrap("#session")[0];a.scrollTop=a.scrollHeight}catch(d){clickdeskLog("disableChatButton = "+d)}}function enableChatButton(){try{document.getElementById("broadcastchat").removeAttribute("disabled");document.getElementById("broadcastchat").removeAttribute("placeholder");document.getElementById("broadcastchat").style.backgroundColor="#FFF"}catch(a){clickdeskLog("enableChatButton = "+a)}}function deleteSession(){try{var e=getPrefs("active_session");var a=getPrefs(VISITOR_EMAIL);var g=CLICKDESK_CHAT_WINDOW_TITLE;var d=CLICKDESK_COMPANY_LOGO;setagentNameandimage(g,d);var h="",f="";try{var l=widgetPrefsJSON.user_phone;if(l!==undefined||l!=null){h=l.user_phone_type;f=l.user_phone_number}if(h!==undefined&&h!=null&&h.length>0&&f!==undefined&&f!=null&&f.length>0){appendCallUsTobody(f,h);clickdeskLog(l);showCallOption()}else{hideCallOption()}}catch(c){clickdeskLog(c)}clickdeskElementWrap(".livilyChatButton").removeClass("min");if(e!==undefined&&e!=null){e=JSON.parse(e);var k=e.visitor_token;clickdeskLog(a);deletePrefs(SESSION_COOKIE_NAME);deletePrefs(CHANNEL_ID);deletePrefs("active_session");var j={};j.command="chat_closed";j.visitor_token=k;if(a!==undefined&&a!=null&&a!=""){j.visitor_email=a}var b=constructSnackRequest(j,CLICKDESK_SERVER_PATH+"/visitor");snack.JSONP(b,function(m){})}}catch(c){clickdeskLog("deleteSession Error "+c)}}function showCallOption(){document.getElementById("callAgentOption").style.display="block";var a=clickdeskElementWrap("ul.tools");snack.each(a,function(b){b.removeAttribute("style");b.style.top="7px"});if(CLICKDESK_TEMPLATE=="cd_medium_template"){var a=clickdeskElementWrap("div.livilycontent");snack.each(a,function(b){b.style.height="185px";b.style.maxHeight="202px"})}if(CLICKDESK_TEMPLATE=="cd_medium_image_template"){var a=clickdeskElementWrap("div.livilycontent");snack.each(a,function(b){setElementStyleByObject(b,{height:"183px",maxHeight:"200px"})})}clickdeskAttachEvent("#callAgentOption","click",function(b){Push2Call.show()})}function hideCallOption(){try{document.getElementById("callAgentOption").style.display="none";if(CLICKDESK_TEMPLATE=="cd_medium_template"){var b=clickdeskElementWrap("div.livilycontent");snack.each(b,function(d){setElementStyleByObject(d,{height:"202px",maxHeight:"202px"})})}if(CLICKDESK_TEMPLATE=="cd_medium_image_template"){var b=clickdeskElementWrap("div.livilycontent");snack.each(b,function(d){setElementStyleByObject(d,{height:"200px",maxHeight:"200px"})})}var c=clickdeskElementWrap("ul.tools");snack.each(c,function(d){setElementStyleByObject(d,{"float":"right",position:"static",top:"7px"})})}catch(a){clickdeskLog("hideCallOption = "+a)}}function appendCallUsTobody(f,h){try{if(_inv!==undefined&&_inv!=null&&_inv!==""){clickdeskLog("if only");clickdeskLog(_inv);_inv.invoxid="getlivechat";custom={};custom.forwardType=h;custom.forwardValue1=f;_inv.custom=custom;clickdeskLog("after appended");clickdeskLog(_inv)}}catch(e){clickdeskLog(e);clickdeskLog("else");var g=(("https:"==document.location.protocol)?"https://":"http://");var b=(("https:"==document.location.protocol)?"https://d2i4snaizu6ojm.cloudfront.net/live-call/":"http://cdn-social.invox.com/live-call/");var d=document.getElementsByTagName("head")[0];var c=document.createElement("script");c.type="text/javascript";c.text="var _inv ={};_inv.side = 'left';_inv.color = '#625D5D';_inv.position = '50%';_inv.invoxid= 'getlivechat';custom = {};custom.forwardType = '"+h+"';custom.forwardValue1 = '"+f+"';  _inv.custom = custom;var invoxPath='"+b+"';";d.appendChild(c);var a=document.createElement("script");a.type="text/javascript";a.src=b+"widget/invox_v6.js";d.appendChild(a)}}function showOfflineLink(){removeElement("session","cd_remove");var a=document.getElementById("cd_rewrite").cloneNode(true);a.id="";a.className="cd_remove";a.innerHTML='<span id="session_timeout_link" onclick="showOfflineForm();" style="color:#0096C0 !important;cursor:pointer;font-size:13px;font-style:italic;color:#000;">['+(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_agent_exceeded_time_label).replace(/&#39;/g,"'")+"]</span>";setElementStyleByObject(a,{display:"block"});document.getElementById("session").appendChild(a)}function setagentNameandimage(b,c){var d=clickdeskElementWrap(".agent_name");snack.each(d,function(e){if(e.length!=0){e.innerHTML=b}});var a=clickdeskElementWrap(".agent_image");snack.each(a,function(e){if(e.length!=0){e.src=c}})}function cdSetFocus(){try{if(cd_ie_browser_version==7){var b=document.getElementById("broadcastchat");b.select();b.focus()}else{document.getElementById("broadcastchat").focus()}}catch(a){clickdeskLog(a)}}function showClickDeskChatLoading(){document.getElementById("session").innerHTML="";document.getElementById("session").innerHTML='<img src="'+glcpath+'images/archiveLoad.gif"  style="position:absolute;top:35%;left:38%;"/>'}function hideClickDeskChatLoading(){document.getElementById("session").innerHTML=""}function clickDeskAutoPopup(){setElementStyleByID("livechat_container",{display:"block"});setElementStyleByID("livechat_popup",{bottom:"0px"});showChatBox();hideBubble()}function getProactiveChat(){IS_PROACTIVE=true;var a=CLICKDESK_PROACTIVE_JSON.message;initBroadcastSession(a)}function cdinitializeOptions(){clickdeskLog("cdinitializeOptions");if(nodeValid("livilyChatButton")){clickdeskAttachEvent("#livilyChatButton","click",function(event){showLivechatPopup()})}if(nodeValid("livilytoolbarbutton")){clickdeskAttachEvent("#livilytoolbarbutton","click",function(event){showLivechatPopup()})}if(nodeValid("livilyChatLink")){clickdeskAttachEvent("#livilyChatLink","click",function(event){showLivechatPopup()})}try{var links=clickdeskElementWrap(".ClickdeskChatLink");for(var i=0;i<links.length;i++){var element=links[i];if(element!=undefined&&links!=null){element.onclick=function(event){showLivechatPopup()}}}}catch(err){clickdeskLog(err)}if(nodeValid("liveChat_minimize")){clickdeskAttachEvent("#liveChat_minimize","click",function(event){CD_Live_Chat.minimize()})}if(nodeValid("liveChat_close")){clickdeskAttachEvent("#liveChat_close","click",function(event){CD_Live_Chat.close()})}addlivilyEvent("emailChatTsToVisitor_cancel","click",function(event){showChatBox()});clickdeskAttachEvent("#cd_emailToVistitor_acl","click",function(event){event.returnValue=false;showChatBox()});addlivilyEvent("email_chat_transcript","click",function(event){showEmailChatToVisitorForm()});clickdeskAttachEvent("#livily_prechat_button","click",function(event){event.returnValue=false;try{document.getElementById("prechat_button").click()}catch(err){clickdeskLog("err = "+err)}});clickdeskAttachEvent("#livily_offline_button","click",function(event){event.returnValue=false;try{document.getElementById("offline_button").click()}catch(err){clickdeskLog("err = "+err)}});clickdeskAttachEvent("#livily_etv_submit","click",function(event){event.returnValue=false;try{document.getElementById("emailChatTsToVisitor_submit").click()}catch(err){clickdeskLog("err = "+err)}});clickdeskAttachEvent("#livily_etv_cancel","click",function(event){event.returnValue=false;try{document.getElementById("emailChatTsToVisitor_cancel").click()}catch(err){clickdeskLog("err = "+err)}});addlivilyEvent("prechat_msg","keyup",function(event){if(event.keyCode==13||event.keyCode==10){document.getElementById("prechat_msg").blur();document.getElementById("prechat_button").click();try{if(event.stopPropagation){event.stopPropagation()}else{event.cancelBubble=true}}catch(err){}return false}});String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};clickdeskAttachEvent("#voice","click",function(event){try{var element=document.getElementById("voice").firstChild;if(hasClass("voice","mute")){clickdeskElementWrap(".voice").removeClass("mute");sound=true;element.className=""}else{clickdeskElementWrap(".voice").addClass("mute");element.className="mute";sound=false}}catch(err){clickdeskLog("err = "+err)}});if(CLICKDESK_TEMPLATE=="cd_small_template"||CLICKDESK_TEMPLATE=="cd_medium_template"){var v=clickdeskElementWrap(".livilytop");snack.each(v,function(eachElement){if(eachElement.length!=0){eachElement.style.display="none"}});document.getElementById("livilyheading").style.display="block"}else{if(CLICKDESK_TEMPLATE=="cd_small_image_template"||CLICKDESK_TEMPLATE=="cd_medium_image_template"){var v=clickdeskElementWrap(".livilytop");snack.each(v,function(eachElement){if(eachElement.length!=0){eachElement.style.display="block"}});document.getElementById("livilyheading").style.display="none"}}clickdeskAttachEvent("#emailChatTsToVisitor_submit","click",function(event){cdResetForm();var sessionJSON=getActiveSession();if(sessionJSON){var sessionId=eval("sessionJSON."+SESSION_ID);if(sessionId){var name=document.getElementById("emailChatTsToVisitor_name").value;var email=document.getElementById("emailChatTsToVisitor_email").value;if(!isValidEmailAddress(email)){document.getElementById("emailChatTsToVisitor_email").style.borderColor="red";document.getElementById("emailChatTsToVisitor_email").focus();return false}else{document.getElementById("sending_chattovisitor").innerHTML=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_send_request_label).replace(/&#39;/g,"'");document.getElementById("emailChatTsToVisitor_submit").setAttribute("disabled",true);var json={};if(name.length>0){json.visitor_name=name}json.visitor_email=email;json.command="send_chat_trascript_to_visitor";json.widget_id=CLICKDESK_WIDGET_ID;json.visitor_token=eval("sessionJSON."+SESSION_VISITOR);json.session_id=sessionId;var params=constructSnackRequest(json,CLICKDESK_SERVER_PATH+"/visitor");snack.JSONP(params,function(response){document.getElementById("emailChatTsToVisitor_submit").removeAttribute("disabled");if(response.status!="success"){document.getElementById("sending_chattovisitor").innerHTML=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_send_failure_mssg_label).replace(/&#39;/g,"'")}else{showChatBox()}})}}else{document.getElementById("sending_chattovisitor").innerHTML=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_nosession_label).replace(/&#39;/g,"'")}}else{document.getElementById("sending_chattovisitor").innerHTML=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_nosession_label).replace(/&#39;/g,"'")}});clickdeskAttachEvent("#offline_button","click",function(event){cdResetForm();var offlineName=document.getElementById("offline_name").value;var offlineEmail=document.getElementById("offline_email").value;var offlineMessage=document.getElementById("offline_msg").value;if(CLICKDESK_OFFLINEFORM_NAME||(offlineName.length>0)){if(OFFLINE_FIRSTFIELDEMAILVSTEXT=="email"){if(!isValidEmailAddress(offlineName)){document.getElementById("offline_name").style.borderColor="red";document.getElementById("offline_name").focus();return false}}else{if(offlineName.length==0||offlineName===undefined){document.getElementById("offline_name").style.borderColor="red";document.getElementById("offline_name").focus();return false}}}if(CLICKDESK_OFFLINEFORM_EMAIL||offlineEmail.length>0){if(OFFLINE_SECONDFIELDEMAILVSTEXT=="email"){if(!isValidEmailAddress(offlineEmail)){document.getElementById("offline_email").style.borderColor="red";document.getElementById("offline_email").focus();return false}}else{if(offlineEmail.length==0||offlineEmail===undefined){document.getElementById("offline_email").style.borderColor="red";document.getElementById("offline_email").focus();return false}}}if(offlineMessage.length==0||offlineMessage===undefined){document.getElementById("offline_msg").style.borderColor="red";document.getElementById("offline_msg").focus();return false}else{cdResetForm();var json={};json.command="new_offline_message";json.visitor_info=getVisitorInfo();json.widget_id=CLICKDESK_WIDGET_ID;var name_label=OFFLINE_NAME_LABEL;var email_label=OFFLINE_EMAIL_LABEL;if(offlineName.length!=0||offlineName!==undefined){visitorName=offlineName;json.visitor_name=offlineName}else{visitorName=""}if(offlineEmail.length!=0||offlineEmail!==undefined){visitorEmail=offlineEmail;json.visitor_email=offlineEmail}else{visitorEmail=""}json.visitor_offline_message=offlineMessage;var fieldsArray=new Array();var offlineJSON=widgetPrefsJSON.offline_form_prefs;if(offlineJSON!==undefined&&offlineJSON!==null){if(offlineJSON.offline_form_name_label!==undefined||offlineJSON.offline_form_name_label!=null){name_label=(offlineJSON.offline_form_name_label)}if(offlineJSON.offline_form_email_label!==undefined||offlineJSON.offline_form_email_label!=null){email_label=(offlineJSON.offline_form_email_label)}}if(offlineName!==undefined&&offlineName!=null){json.visitor_name=offlineName;var field1={};field1.fieldName=name_label;field1.fieldValue=offlineName;fieldsArray.push(field1)}if(offlineEmail!==undefined&&offlineEmail!=null){json.visitor_email=offlineEmail;var field2={};field2.fieldName=email_label;field2.fieldValue=offlineEmail;fieldsArray.push(field2)}try{var strigifyString="[";for(var i=0;i<fieldsArray.length;i++){if(i!=(fieldsArray.length-1)){strigifyString=strigifyString+JSON.stringify(fieldsArray[i])+","}else{strigifyString=strigifyString+JSON.stringify(fieldsArray[i])}}strigifyString=strigifyString+"]";json.offline_fields=strigifyString}catch(err){}CLICKDESK_createCookie("visitor_email",visitorEmail,10);CLICKDESK_createCookie("visitor_name",visitorName,10);document.getElementById("offline_button").setAttribute("disabled",true);document.getElementById("cd_loading").innerHTML=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_send_request_label).replace(/&#39;/g,"'");document.getElementById("cd_loading").style.display="inline";var params=constructSnackRequest(json,CLICKDESK_SERVER_PATH+"/visitor");try{snack.JSONP(params,function(response){clickdeskLog(response);if(response.status=="success"){document.getElementById("offline_button").removeAttribute("disabled");document.getElementById("ClickdeskofflinethxMsgName").innerHTML="Hey "+CLICKDESK_readCookie("visitor_name")+",";document.getElementById("ClickdeskofflineSucsMsg").innerHTML=(WIDGET_CUSTOM_MESSAGES.offline_send_success_label).replace(/&#39;/g,"'");showOfflineMsgSendSuccess()}else{document.getElementById("offline_button").removeAttribute("disabled");document.getElementById("cd_loading").innerHTML=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_send_failure_mssg_label).replace(/&#39;/g,"'")}})}catch(err){clickdeskLog(err)}}});clickdeskAttachEvent("#prechat_button","click",function(event){cdResetForm();var prechatName=document.getElementById("prechat_name").value;var prechatEmail=document.getElementById("prechat_email").value;var prechatMessage=document.getElementById("prechat_msg").value;prechatMessage=prechatMessage.trim();prechatEmail=prechatEmail.trim();if(document.getElementById("prechat_custom")!==undefined&&document.getElementById("prechat_custom")!=null){prechatCustom=document.getElementById("prechat_custom").value}if(CLICKDESK_ONLINEFORM_NAME||(prechatName.length>0)){if(PRECHAT_FIRSTFIELDEMAILVSTEXT=="email"){if(!isValidEmailAddress(prechatEmail)){document.getElementById("prechat_name").style.borderColor="red";document.getElementById("prechat_name").focus();document.getElementById("valid_email").innerHTML=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_email_field_label).replace(/&#39;/g,"'");document.getElementById("valid_email").style.visibility="visible";return false}}else{if(prechatName.length==0||prechatName===undefined){document.getElementById("prechat_name").style.borderColor="red";document.getElementById("prechat_name").focus();document.getElementById("valid_email").innerHTML=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_name_field_label).replace(/&#39;/g,"'");document.getElementById("valid_email").style.visibility="visible";return false}}}if(CLICKDESK_ONLINEFORM_EMAIL||prechatEmail.length>0){if(PRECHAT_SECONDFIELDEMAILVSTEXT=="email"){if(!isValidEmailAddress(prechatEmail)){document.getElementById("prechat_email").style.borderColor="red";document.getElementById("prechat_email").focus();document.getElementById("valid_email").innerHTML=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_email_field_label).replace(/&#39;/g,"'");document.getElementById("valid_email").style.visibility="visible";return false}}else{if(prechatEmail.length==0||prechatEmail===undefined){document.getElementById("prechat_email").style.borderColor="red";document.getElementById("prechat_email").focus();document.getElementById("valid_email").innerHTML=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_name_field_label).replace(/&#39;/g,"'");document.getElementById("valid_email").style.visibility="visible";return false}}}if(CLICKDESK_ONLINEFORM_CUSTOM_FIELD!==undefined&&CLICKDESK_ONLINEFORM_CUSTOM_FIELD=="yes"){if(CLICKDESK_ONLINEFORM_CUSTOM_FIELD_REQUIRED||(prechatCustom.length>0)){if(PRECHAT_CUSTOMFIELDEMAILVSTEXT=="email"){if(!isValidEmailAddress(prechatEmail)){document.getElementById("prechat_custom").style.borderColor="red";document.getElementById("prechat_custom").focus();document.getElementById("valid_email").innerHTML=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_email_field_label).replace(/&#39;/g,"'");document.getElementById("valid_email").style.visibility="visible";return false}}else{if(prechatCustom===undefined||prechatCustom.length==0){document.getElementById("prechat_custom").style.borderColor="red";document.getElementById("prechat_custom").focus();document.getElementById("valid_email").innerHTML=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_name_field_label).replace(/&#39;/g,"'");document.getElementById("valid_email").style.visibility="visible";return false}}}}if(prechatMessage.length==0||prechatMessage===undefined){document.getElementById("prechat_msg").style.borderColor="red";document.getElementById("prechat_msg").focus();document.getElementById("valid_email").innerHTML=(WIDGET_CUSTOM_MESSAGES.customstatusmssgs_message_field_label).replace(/&#39;/g,"'");document.getElementById("valid_email").style.visibility="visible";return false}else{cdResetForm();var text=document.getElementById("prechat_msg").value;sendMessage(text,CLICKDESK_CHAT_AGENT_NAME,"broadCast");showChatBox();visitorEmail=prechatEmail;visitorName=prechatName;CLICKDESK_createCookie("visitor_email",visitorEmail,10);CLICKDESK_createCookie("visitor_name",visitorName,10)}})}function divHover(b){if(b!=null&&b!==undefined){b=b.firstChild}if(b!=null&&b!==undefined){for(var a=0;a<b.childNodes.length-1;a++){if(b.childNodes[a].id=="cd_date"){b.childNodes[a].style.visibility="visible"}}}}function divOut(b){if(b!=null&&b!==undefined){b=b.firstChild}if(b!=null&&b!==undefined){for(var a=0;a<b.childNodes.length-1;a++){if(b.childNodes[a].id=="cd_date"){b.childNodes[a].style.visibility="hidden"}}}}function cdResetForm(){document.getElementById("offline_name").style.borderColor="#CCC";document.getElementById("offline_email").style.borderColor="#CCC";document.getElementById("offline_msg").style.borderColor="#CCC";document.getElementById("prechat_name").style.borderColor="#CCC";document.getElementById("prechat_email").style.borderColor="#CCC";document.getElementById("prechat_msg").style.borderColor="#CCC";setElementStyleByID("prechat_custom",{borderColor:"#CCC"});document.getElementById("valid_email").style.visibility="hidden";document.getElementById("offline_valid_email").style.visibility="hidden";document.getElementById("emailChatTsToVisitor_name").style.borderColor="#CCC";document.getElementById("emailChatTsToVisitor_email").style.borderColor="#CCC";document.getElementById("emailChatTsToVisitorFormError").style.display="none";document.getElementById("sending_chattovisitor").innerHTML=""}function isValidEmailAddress(d){var c=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);var e=d.split(",");for(var b=0;b<e.length;b++){e[b]=e[b].replace(/^\s*/,"").replace(/\s*$/,"");var a=c.test(e[b]);if(!a){return false}}return true}function showChatBox(){try{document.getElementById("valid_email").style.visibility="hidden";document.getElementById("session").style.display="block";document.getElementById("valid_email").style.visibility="hidden";document.getElementById("offlineForm").style.display="none";document.getElementById("prechatForm").style.display="none";document.getElementById("offlinethxmsg").style.display="none";document.getElementById("emailChatTsToVisitorForm").style.display="none";var d=clickdeskElementWrap(".livilyfooter");snack.each(d,function(e){if(e.length!=0){e.style.display="block"}});var a=clickdeskElementWrap("div.livilycontent");snack.each(a,function(e){if(e.length!=0){e.style.display="block"}});hideBubble();document.getElementById("livechat_container").style.display="block";clickdeskLog("slidedown");var c=document.getElementById("livechat_popup").offsetHeight;clickDeskSlideUP(c,clickDeskShow)}catch(b){clickdeskLog("showChatBox"+b)}}function showOfflineForm(){try{var e=clickdeskElementWrap(".livilyfooter");snack.each(e,function(f){if(f.length!=0){f.style.display="none"}});document.getElementById("session").style.display="none";document.getElementById("prechatForm").style.display="none";document.getElementById("offlinethxmsg").style.display="none";document.getElementById("emailChatTsToVisitorForm").style.display="none";document.getElementById("offlineForm").style.display="block";document.getElementById("cd_loading").innerHTML="Sending...";document.getElementById("cd_loading").style.display="none";document.getElementById("offline_msg").value="";visitorEmail=CLICKDESK_readCookie("visitor_email");visitorName=CLICKDESK_readCookie("visitor_name");if(visitorEmail!==undefined&&visitorEmail!==null){clickdeskElementWrap("#offline_email")[0].value=visitorEmail}if(visitorName!==undefined&&visitorName!==null){clickdeskElementWrap("#offline_name")[0].value=visitorName}var b=widgetPrefsJSON.javascript_plugin_prefs;if(b!=null&&b!==undefined){for(var a in b){if(a.indexOf("_value")!=-1){assignPluginVarToInput(b,b[a])}}}hideBubble();document.getElementById("livechat_container").style.display="block";var d=document.getElementById("livechat_popup").offsetHeight;clickDeskSlideUP(d,clickDeskShow);clickdeskLog("slidedown")}catch(c){clickdeskLog("showOfflineForm"+c)}}function showOfflineMsgSendSuccess(){try{var c=clickdeskElementWrap(".livilyfooter");snack.each(c,function(d){if(d.length!=0){d.style.display="none"}});document.getElementById("session").style.display="none";document.getElementById("prechatForm").style.display="none";document.getElementById("offlineForm").style.display="none";document.getElementById("emailChatTsToVisitorForm").style.display="none";document.getElementById("offlinethxmsg").style.display="block";document.getElementById("offline_msg").value="";hideBubble();document.getElementById("livechat_container").style.display="block";var b=document.getElementById("livechat_popup").offsetHeight;clickDeskSlideUP(b,clickDeskShow)}catch(a){clickdeskLog("showOfflineForm"+a)}}function showPrechatForm(){try{var e=clickdeskElementWrap(".livilyfooter");snack.each(e,function(f){if(f.length!=0){f.style.display="none"}});document.getElementById("session").style.display="none";document.getElementById("offlineForm").style.display="none";document.getElementById("offlinethxmsg").style.display="none";document.getElementById("prechatForm").style.display="block";document.getElementById("emailChatTsToVisitorForm").style.display="none";setElementStyleByID("livilyfooter",{display:"none",position:"relative"});if(PRECHAT_REFILL_FORM_FILEDS=="yes"){visitorEmail=CLICKDESK_readCookie("visitor_email");visitorName=CLICKDESK_readCookie("visitor_name");if(visitorEmail!==undefined&&visitorEmail!==null){document.getElementById("prechat_email").value=visitorEmail}if(visitorName!==undefined&&visitorName!==null){document.getElementById("prechat_name").value=visitorName}}else{clickdeskElementWrap("#prechat_email")[0].value="";clickdeskElementWrap("#prechat_name")[0].value="";if(document.getElementById("prechat_custom")!==undefined&&document.getElementById("prechat_custom")!=null){document.getElementById("prechat_custom").value=""}}document.getElementById("prechat_msg").value="";var b=widgetPrefsJSON.javascript_plugin_prefs;if(b!=null&&b!==undefined){for(var a in b){if(a.indexOf("_value")!=-1){assignPluginVarToInput(b,b[a])}}}hideBubble();document.getElementById("livechat_container").style.display="block";var d=document.getElementById("livechat_popup").offsetHeight;clickDeskSlideUP(d,clickDeskShow);clickdeskLog("slidedown")}catch(c){clickdeskLog("showPrechatForm "+c)}}function assignPluginVarToInput(e,f){if(isvalidPlugin(f)&&evalJavascriptExp(f)!="Unknown"){var b=clickdeskElementWrap("#livechat_popup input");for(var d=0;d<b.length;d++){var c=b[d];if(b[d].type!="submit"&&b[d].type!="button"){var a=c.name;if(a!==undefined&&a!=null){a=a.replace(/ /g,"");if(a==f){b[d].value=evalJavascriptExp(f)}}}}}}function showEmailChatToVisitorForm(){try{var c=clickdeskElementWrap(".livilyfooter");snack.each(c,function(d){if(d.length!=0){d.style.display="none"}});document.getElementById("session").style.display="none";document.getElementById("prechatForm").style.display="none";document.getElementById("offlinethxmsg").style.display="none";if(document.getElementById("callAgentOption").style.display=="block"){if(CLICKDESK_TEMPLATE=="cd_small_template"||CLICKDESK_TEMPLATE=="cd_small_image_template"){document.getElementById("emailChatTsToVisitorForm").style.height="286px"}else{document.getElementById("emailChatTsToVisitorForm").style.height="313px"}}else{if(CLICKDESK_TEMPLATE=="cd_small_template"||CLICKDESK_TEMPLATE=="cd_small_image_template"){document.getElementById("emailChatTsToVisitorForm").style.height="270px"}else{document.getElementById("emailChatTsToVisitorForm").style.height="314px"}}if(PRECHAT_REFILL_FORM_FILEDS=="yes"){visitorEmail=CLICKDESK_readCookie("visitor_email");visitorName=CLICKDESK_readCookie("visitor_name");if(visitorEmail!==undefined&&visitorEmail!==null){clickdeskElementWrap("#emailChatTsToVisitor_email")[0].value=visitorEmail}if(visitorName!==undefined&&visitorName!==null){clickdeskElementWrap("#emailChatTsToVisitor_name")[0].value=visitorName}}else{clickdeskElementWrap("#emailChatTsToVisitor_name")[0].value="";clickdeskElementWrap("#emailChatTsToVisitor_email")[0].value=""}document.getElementById("sending_chattovisitor").innerHTML="";document.getElementById("emailChatTsToVisitorForm").style.display="block";document.getElementById("offlineForm").style.display="none";document.getElementById("cd_loading").innerHTML="Sending...";document.getElementById("cd_loading").style.display="none";hideBubble();document.getElementById("livechat_container").style.display="block";var b=document.getElementById("livechat_popup").offsetHeight;clickDeskSlideUP(b,clickDeskShow);clickdeskLog("slidedown")}catch(a){clickdeskLog("showOfflineForm"+a)}}function hideBubble(){try{document.getElementById("livilyChatButton").style.display="none";document.getElementById("livilytoolbarbutton").style.display="none";document.getElementById("spinner_bubble").style.display="none"}catch(a){clickdeskLog("hideBubble ="+a)}}function showLivechatPopup(){clearTimeout(CLICKDESK_TIME);CLICKDESK_createCookie("active_popup","active");CD_Live_Chat.show()}function sendClickDeskChatMessage(){try{var b=clickdeskElementWrap("#broadcastchat");var c=b[0].value;c=c.trim();if(c!=undefined&&c!=null&&c.length!=0){sendMessage(c,CLICKDESK_CHAT_AGENT_NAME)}else{document.getElementById("broadcastchat").focus()}}catch(a){clickdeskLog(a)}return false}try{window.onload=$CLICKDESK}catch(err){}function playRecvSound(){playSound()}function playSendSound(){playSound()}function playSound(){var c=glcpath+"js/sound.mp3";var b=glcpath+"js/sound.wav";var a;try{a=new Audio(c);a.play()}catch(d){clickdeskLog("playSound Error :"+d);try{if(cd_ie_browser_version!==undefined&&cd_ie_browser_version!=null&&cd_ie_browser_version<=9){return}try{if(BrowserDetect.browser=="Firefox"&&BrowserDetect.version<3.6){return}if(FlashDetect.installed){document.getElementById("playsound").innerHTML='<object width="0" height="0"><param name="src" value="'+c+'"><param name="autoplay" value="true"><param name="autostart" value="true"> <param name="controller" value="true"><embed src="'+c+'" controller="true" autoplay="true" autostart="True" type="audio/mp3" /></object>'}else{return}}catch(f){}}catch(d){clickdeskLog("playSound in flash :"+d)}}}function getUrlVars(){var d=[],c;var a=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var b=0;b<a.length;b++){c=a[b].split("=");d.push(c[0]);d[c[0]]=c[1]}return d}function enableConsoleLogging(){var a=true;if(typeof console==="undefined"||!a){console={log:function(){}}}if(typeof(console.log)==="undefined"||!a){console.log=function(){return 0}}}function LivilyLog(a){enableConsoleLogging();clickdeskLog(a)}function getUnknownVisitorInfo(){var a="Unknown";return a}function getVisitorInfo(){var h={};var f=document.location.href;var a=getPrefs(CLICKDESK_REFERRER);if(a==null||a===undefined){a=document.referrer}var j=getPrefs(CD_CLIENT_DETAILS);if(j){if(j){h=JSON.parse(j)}else{h={}}}else{h.browser=BrowserDetect.browser;h.browser_version=BrowserDetect.browser;h.os=BrowserDetect.OS;h.flash_installed=FlashDetect.installed;if(FlashDetect.installed){h.flash_version=FlashDetect.raw}if(IS_CD_SSL){h.city=getUnknownVisitorInfo();h.country=getUnknownVisitorInfo();h.country_code=getUnknownVisitorInfo();h.region=getUnknownVisitorInfo();h.latitude=getUnknownVisitorInfo();h.longitude=getUnknownVisitorInfo()}else{h.city=geoip_city();h.country=geoip_country_name();h.country_code=geoip_country_code();h.region=geoip_region_name();h.latitude=geoip_latitude();h.longitude=geoip_longitude()}setPrefs(CD_CLIENT_DETAILS,JSON.stringify(h),3)}if(f!==undefined&&f!=null){h.url=encodeURIComponent(f)}if(a!==undefined&&a!=null&&a!="null"){h.referrer=encodeURIComponent(a)}var b=getPrefs(ARCHIVE_SESSION);try{var e={};var c={};var g=widgetPrefsJSON.javascript_plugin_prefs;if(g!=null&&g!==undefined){if(isvalidPlugin(g.javascript_var1_name)){if(isvalidPlugin(g.javascript_var1_value)){c.jsplugin_var1_name=g.javascript_var1_name;javascrpt_plugin=true;c.jsplugin_var1_value=evalJavascriptExp(g.javascript_var1_value)}}if(isvalidPlugin(g.javascript_var2_name)){if(isvalidPlugin(g.javascript_var2_value)){c.jsplugin_var2_name=g.javascript_var2_name;javascrpt_plugin=true;c.jsplugin_var2_value=evalJavascriptExp(g.javascript_var2_value)}}if(isvalidPlugin(g.javascript_var3_name)){if(isvalidPlugin(g.javascript_var3_value)){c.jsplugin_var3_name=g.javascript_var3_name;javascrpt_plugin=true;c.jsplugin_var3_value=evalJavascriptExp(g.javascript_var3_value)}}if(isvalidPlugin(g.javascript_var4_name)){if(isvalidPlugin(g.javascript_var4_value)){c.jsplugin_var4_name=g.javascript_var4_name;javascrpt_plugin=true;c.jsplugin_var4_value=evalJavascriptExp(g.javascript_var4_value)}}if(isvalidPlugin(g.javascript_var5_name)){if(isvalidPlugin(g.javascript_var5_value)){c.jsplugin_var5_name=g.javascript_var5_name;javascrpt_plugin=true;c.jsplugin_var5_value=evalJavascriptExp(g.javascript_var5_value)}}if(javascrpt_plugin){e.jsplugin=c}}h.plugins=e}catch(d){return JSON.stringify(h)}return JSON.stringify(h)}function isvalidPlugin(a){if(a.length>0){return true}else{return false}}function evalJavascriptExp(exp){var jsVarialble=exp;var value="";try{value=eval(jsVarialble);if(value===undefined||value==null){value=getUnknownVisitorInfo()}}catch(err){value=getUnknownVisitorInfo()}return value}function initWindow(b){var g=b;if(g){clickdeskLog(g);document.getElementById("broadcastchat").removeAttribute("placeholder");document.getElementById("broadcastchat").value="";for(var c=0;c<g.length;c++){var f=g[c];window.dDate=new Date();if(f.message===undefined){}else{var d=parseInt(f.epoch_time);if(d<10000000000){d*=1000}dDate.setTime(d);var h=dDate.getHours()+":"+dDate.getMinutes();var e=f.from;var a=f.message;if(e==CLICKDESK_VISITOR){e=CLICKDESK_CHAT_AGENT_NAME}else{e=CLICKDESK_AGENT_NICK_NAME}appendToWindow(a,e,h)}}}}function appendMessage(b,a){appendToWindow(b,a)}function appendToWindow(r,a,e){var c="";var m=document.getElementById("session").lastChild;if(m!=null&&c!==undefined){var f=m.firstChild;if(f!=null&&f!==undefined){for(var l=0;l<f.childNodes.length-1;l++){if(f.childNodes[l].id=="cd_name"){c=f.childNodes[l].innerHTML}}}}if(r!==undefined){if(r.indexOf("http://")!=-1||r.indexOf("https://")!=-1||r.indexOf("www.")!=-1){r=cdMessageToAnchor(r)}}c=c.replace(":","");if(c==a||a==undefined||a=="srvstaticmsg"){var g=document.getElementById("cd_rewrite").cloneNode(true);g.id="";cdAppendData(g,"cd_rewrite_msg",r);setElementStyleByObject(g,{display:"block"});if(a=="srvstaticmsg"){setElementStyleByObject(g,{fontStyle:"italic"});document.getElementById("session").appendChild(g)}else{document.getElementById("session").lastChild.appendChild(g)}}else{var b=document.getElementById("clickdesk_new_message").cloneNode(true);var o;var d=new Date();var q;var h;if(e===undefined){q=d.getHours();h=d.getMinutes()}else{q=parseInt(e.substring(0,e.indexOf(":")));h=parseInt(e.substring(e.indexOf(":")+1))}if(parseInt(h)<10){h="0"+h}if(parseInt(q)>=12){o="PM"}else{o="AM"}if(parseInt(q)>12){q=q-12}e=q+":"+h+" "+o;b.id="";for(var l=0;l<b.childNodes.length;l++){var n=b.childNodes[l];for(var k=0;k<n.childNodes.length;k++){if(n.childNodes[k]!==undefined){if(n.childNodes[k].id=="cd_name"){cdAppendText(n.childNodes[k],a+":")}else{if(n.childNodes[k].id=="cd_chat_msg"){cdAppendText(n.childNodes[k],"  "+r+" ")}else{if(n.childNodes[k].id=="cd_date"){cdAppendText(n.childNodes[k],e)}}}}}if(b.childNodes[l].id=="cd_name"){cdAppendText(b.childNodes[l],a+":")}else{if(b.childNodes[l].id=="cd_chat_msg"){cdAppendText(b.childNodes[l],"  "+r+" ")}else{if(b.childNodes[l].id=="cd_date"){cdAppendText(b.childNodes[l],e+"")}}}}b.onmouseover=function(){divHover(b)};b.onmouseout=function(){divOut(b)};b.style.display="block";clickdeskElementWrap("#session")[0].appendChild(b)}var s=clickdeskElementWrap("#session")[0];s.scrollTop=s.scrollHeight;cdSetFocus()}function cdAppendData(d,f,e){if(d!=null&&d!==undefined){for(var b=0;b<d.childNodes.length;b++){var c=d.childNodes[b];for(var a=0;a<c.childNodes.length;a++){if(c.childNodes[a]!==undefined){if(c.childNodes[a].id==f){cdAppendText(c.childNodes[a],e)}}}if(d.childNodes[b].id==f){cdAppendText(d.childNodes[b],e)}}}}function cdAppendText(a,b){if(a!=null&&a!==undefined){a.innerHTML=b}}function cdMessageToAnchor(k){var c=k.split(" ");var h="";if(c.length>0){for(var f=0;f<c.length;f++){var a=c[f];try{a=a.trim();var d=a.split("\n");if(d.length>0){for(var e=0;e<d.length;e++){var g=d[e];if(g.indexOf("http://")==0){h+=" <a href="+g+' target="_blank" class="cd_hyperlink">'+g+"</a>  "}else{if(g.indexOf("https://")==0){h+=" <a href="+g+' target="_blank" class="cd_hyperlink">'+g+"</a>  "}else{if(g.indexOf("www.")==0){h+=" <a href='http://"+g+'\' target="_blank" class="cd_hyperlink">'+g+"</a>  "}else{h+=" "+g}}}}}else{if(a.indexOf("http://")==0){h+=" <a href="+a+' target="_blank" class="cd_hyperlink">'+a+"</a>  "}else{if(a.indexOf("https://")==0){h+=" <a href="+a+' target="_blank" class="cd_hyperlink">'+a+"</a>  "}else{if(a.indexOf("www.")==0){h+=" <a href='http://"+a+'\' target="_blank" class="cd_hyperlink">'+a+"</a>  "}else{h+=" "+a}}}}}catch(b){clickdeskLog(b)}}}else{h=k}return h};